'
'                                                     Hannover,19.02.95
' Hallo Amos-User,
'
' Hier habe ich ein simples Programm ,um Telefon-Nummer aufzulisten
' Ihr könnt es euch wieder in euren AmosEditor einladen
' Menu Projekt Merge ascii Telefon.asc
'
' Dann müßt Ihr noch eine Schublade TelNr erzeugen.
'
' Bei irgendwelchen Problemen oder Tips & Tricks  anrufen oder schreiben
'
'
' Karl-Heinz Bader ; Merianweg 40 ; 30655 HANNOVER     Tel 0511/549 91 40
'
Rem********************************************************************
Rem*                                                                  *
Rem*            Eine simple Telefon - Liste  V_1.0                    *
Rem*                                                                  *
Rem*            von K.-H. Bader , Feb '95    P D - Programm           *
Rem*                                                                  *
Rem*            Für das HannoverscheAmigaMagazin # 5                  *
Rem*                                                                  *
Rem********************************************************************
'
Set Buffer 80
Screen Close 0
Screen Open 1,320,256,16,Lowres : Cls 0 : Paper 0
Colour 0,$888 : Colour Back $888 : Colour 1,$888
Curs Off : Flash Off
Dir$="HAM#5:TelNr/" : Rem  Diesen Pfad kann man für eigene Disks ändern
'
ANFANG
'
Procedure ANFANG
   Screen Open 1,320,256,16,Lowres
   Colour 0,$888 : Colour Back $888 : Colour 1,$1
   Curs Off : Flash Off : Paper 0 : Cls 0
   Reserve Zone 3
   Locate 0,4 : Centre "TELEFON-LISTE"
   Pen 7 : Locate 0,30 : Centre "(c) '95 by Bader Software V_1.0"
   OS2GADGET["EINGABE",10,100,1]
   OS2GADGET["AUSGABE",115,100,2]
   OS2GADGET["LÖSCHEN ",230,100,3]
   WHATGADGET
End Proc
'
Procedure WHATGADGET
   A$=""
   Repeat
      If Mouse Key
         GAD=Mouse Zone
If GAD=1 : Ink 5 : Text 16,112,"EINGABE " : Wait 10 : Proc EINGABE : End If
If GAD=2 : Ink 5 : Text 121,112,"AUSGABE" : Wait 10 : Proc AUSGABE : End If
If GAD=3 : Ink 5 : Text 236,112,"LÖSCHEN " : Proc DEL : End If
      End If
 A$=Inkey$ : Rem Tastatur abfragen
Until A$=Chr$(27) : Edit
End Proc
'
Procedure OS2GADGET[TXT$,X,Y,NR]
   Pen 2 : Locate 0,25 : Centre "> ESC < zum Beenden !"
   X2=X+16+Text Length(TXT$) : Y2=Y+18
   Ink 2 : Draw X,Y To X2,Y
   Draw X,Y To X,Y2
   Ink 1 : Draw X2,Y2 To X,Y2
   Draw X2,Y2 To X2,Y
   Ink 1,0 : Text X+8,Y+12,TXT$
   Set Zone NR,X,Y To X2,Y2
End Proc
'
Procedure EINGABE
   Screen Open 1,320,256,16,Lowres : Cls 0 : Paper 0
   Colour 0,$888 : Colour Back $888 : Colour 1,$888
   ADE:
   Cls 0
   Locate 0,10
   Input "Name        :";D$
   Input "Vorname     :";E$
   Input "Telefon     :";F$
'
Rem  Diesen Pfad kann man für eigene Disks ändern
'
   EG$=Fsel$("HAM#5:TelNr/","","Sichern als")
'
   If EG$="" Then Proc ANFANG
   Open Out 1,EG$
   Print #1,D$
   Print #1,E$
   Print #1,F$
   Close 1
   Goto AF
   AF:
   Do
      Locate 0,20
      Input "Weiter J/N ";Y$
      If Y$="j" or Y$="J" Then Goto ADE
      If Y$="n" or Y$="N" Then Proc ANFANG
   Loop
End Proc
'
Procedure AUSGABE
   BEGINN:
   Screen Open 1,320,256,16,Lowres : Paper 0 : Pen 1
   Colour 0,$888 : Colour Back $888 : Colour 1,$1
   Curs Off : Cls 0
   Reserve Zone 3
'
Rem  Diesen Pfad kann man für eigene Disks ändern
'
   EG$=Fsel$("HAM#5:TelNr/","","Telefon-Nr. auswählen")
'
   If EG$="" Then Proc ANFANG
   Open In 1,EG$
   Input #1,D$
   Input #1,E$
   Input #1,F$
   Locate 0,10
   A$=Space$(10)
   Print A$; : Print D$
   Print A$; : Print E$
   Print A$; : Print F$
   Close 1
   AGAIN:
   Pen 1 : Locate 0,2 : Centre "Telefon-Nummer"
   Pen 13 : Paper 0
   '
   Locate 10,7
   Print Border$(Zone$("WEITER",1),1)
   '
   Locate 24,7
   Print Border$(Zone$("ENDE",2),1)
   '
   Do
    M=Mouse Zone
    If Mouse Key and M=2 : Proc ANFANG : End If
    M=Mouse Zone
    If Mouse Key=0 and M=1 : Inverse On : Locate 10,7 : Print "WEITER" : End If
    If Mouse Key=0 and M=0 : Inverse Off : Locate 10,7 : Print "WEITER" :End If
    If Mouse Key=0 and M=2 : Inverse On : Locate 24,7 : Print "ENDE" : End If
    If M=0 : Inverse Off : Locate 24,7 : Print "ENDE" : End If
    If Mouse Key=1 and M=1 : Goto BEGINN : End If
   Loop
   '
End Proc
'
Procedure DEL
   D$=Fsel$("","","Adresse löschen?")
   If D$="" Then Proc ANFANG
   Kill D$
   D$=""
   Proc ANFANG
End Proc
'
' Ist ja alles sehr simple , aber es funktioniert so.Der Nachteil oder
'
' Vorteil ist : Jede TelNr. wird einzeln abgespeichert.Man braucht so keine
'
' Maske programmieren.
'
'  Viel Spaß  wünscht   Charly
'
'  *EOF
