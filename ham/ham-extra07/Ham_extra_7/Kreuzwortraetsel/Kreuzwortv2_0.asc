'
' Kreuzwort.Amos V2.0 geschrieben von H.G. Krames Jan.-Mrz. 1996 
' Alle Rätsel-Dateien wurden mir von Henry König, Bornheide 71,
' 22549 Hamburg mit freundlicher Genehmigung zur Verfügung gestellt. 
'  
Unpack 10 To 0
Hide On 
Screen Display 0,,300,,
For Y=300 To 40 Step -4
   Screen Display 0,,Y,,
   Wait Vbl 
Next Y
Dim FRG$(54),ANT$(54),MESS$(13)
Global EING$,FRG$(),ANT$(),MESS$(),CL,FRAGE,GEL,MK,NS
Set Input 10,-1
'
INIT_0
INIT_1
'
HAUPTPROGRAMM:
GEL=0
FR$=Str$(FRAGE)-" "
FR$=String$("0",2-Len(FR$))+FR$
SH[590,146,FR$,2,1]
SH[415,146,MESS$(11),2,1]
SH[415,206,MESS$(2),2,1]
Do 
   If GEL=54
      Add NS,1
      NEUES_SPIEL
      Goto HAUPTPROGRAMM
   End If 
   '  
   NEWEING:
   Input At(52,29);MK$
   MK=Val(MK$)
   If MK=0
      Goto NEWEING
   End If 
   '
   Cls 4,410,197 To 635,210
   SH[415,206,FRG$(MK),2,1]
   NUMBER
   '
   Input At(52,29);ANTW$
   '
   If ANTW$=""
      Cls 4,410,167 To 636,180
      Cls 4,410,197 To 635,210
      SH[415,206,MESS$(2),2,1]
      Goto NEWEING
   End If 
   If ANTW$="a"
      AUFLOESUNG
      Cls 4,410,167 To 636,180
      Cls 4,410,197 To 635,210
      SH[415,206,MESS$(2),2,1]
      Goto NEWEING
   End If 
   If Upper$(ANTW$)=ANT$(MK)
      Curs Off 
      SETWORD
      CL=2
      CLEAR
   End If 
   If Upper$(ANTW$)<>ANT$(MK)
      Curs Off 
      CL=1
      CLEAR
   End If 
Loop 
'
Procedure INIT_0
   '
   Flash 3,"(f00,25)(ff0,25)"
   Gr Writing 0
   Paper 4 : Pen 2
   Make Icon Mask 
   For M=1 To 13
      Read MESS$(M)
   Next M
   '
   Data "Ausgewähltes Feld  :"
   Data "Ein Lösungsfeld auswählen !"
   Data "Richtig !"
   Data "Leider falsch !"
   Data "Kreuzwort-Rätsel auf dem Amiga. Written in Amos-Pro März 1996"
   Data "von H.- G. Krames. Alle Rätsel sind von Henry König, Hamburg"
   Data "Bitte eine Rätsel-Datei laden ( 1 - 100 ) :"
   Data "Möchtest Du nochmal raten ? ( J = nochmal raten / N = Programm beenden )"
   Data "Auf ein neues Spiel !"
   Data "Dann bis zum nächsten mal ...und tschüss !"
   Data "Noch offene Fragen :"
   Data "Rätsel-Auflösung zu Rätsel Nr :"
   Data "Zum Rätselfenster  =  Esc ..."
End Proc
Procedure INIT_1
   '
   Screen Open 1,640,48,16,$8000
   Get Palette 0
   Curs Off : Cls 0 : Hide On 
   Gr Writing 0
   Paper 0 : Pen 7
   Ink 5
   Polyline 0,48 To 0,0 To 638,0
   Polyline 1,47 To 1,1 To 637,1
   Ink 4
   Polyline 1,47 To 639,47 To 639,0
   Polyline 2,46 To 638,46 To 638,1
   Ink 14
   Box 3,2 To 636,45
   For S=48 To 170 Step 2
      Screen Display 1,,S,,
      Wait Vbl 
   Next S
   If NS=0
      For I=1 To Len(MESS$(5))
         SH[10+I*10,14,Mid$(MESS$(5),I,1),2,1]
         Wait 2
      Next I
      For I=1 To Len(MESS$(6))
         SH[10+I*10,26,Mid$(MESS$(6),I,1),2,1]
         Wait 2
      Next I
   End If 
   If NS>0
      For I=1 To Len(MESS$(9))
         SH[10+I*10,20,Mid$(MESS$(9),I,1),2,1]
         Wait 2
      Next I
   End If 
   For I=1 To Len(MESS$(7))
      SH[10+I*10,38,Mid$(MESS$(7),I,1),2,1]
      Wait 2
   Next I
   DAT$="Data/Raetsel."
   Input At(58,4);EING$
   Curs Off 
   LADE$=DAT$+EING$
   Open In 1,LADE$
   For L=1 To 54
      Input #1,ANT$(L),FRG$(L)
   Next L
   Close 1
   Wait 10
   For S=170 To 48 Step -2
      Screen Display 1,,S,,
      Wait Vbl 
   Next S
   Screen Close 1
   FRAGE=54
End Proc
Procedure SETWORD
   '
   Ink 2
   If MK=1 Then For I=1 To Len(ANT$(1)) : SH[53,13+I*15,Mid$(ANT$(1),I,1),2,1] : Next I : Paste Icon 14,18,1
   If MK=2 Then For I=1 To Len(ANT$(2)) : SH[83,13+I*15,Mid$(ANT$(2),I,1),2,1] : Next I : Paste Icon 104,18,1
   If MK=3 Then For I=1 To Len(ANT$(3)) : SH[143,28+I*15,Mid$(ANT$(3),I,1),2,1] : Next I : Paste Icon 134,18,1
   If MK=4 Then For I=1 To Len(ANT$(4)) : SH[173,13+I*15,Mid$(ANT$(4),I,1),2,1] : Next I : Paste Icon 194,18,1
   If MK=5 Then For I=1 To Len(ANT$(5)) : SH[233,28+I*15,Mid$(ANT$(5),I,1),2,1] : Next I : Paste Icon 224,18,1
   If MK=6 Then For I=1 To Len(ANT$(6)) : SH[293,13+I*15,Mid$(ANT$(6),I,1),2,1] : Next I : Paste Icon 254,18,1
   If MK=7 Then For I=1 To Len(ANT$(7)) : SH[323,28+I*15,Mid$(ANT$(7),I,1),2,1] : Next I : Paste Icon 314,18,1
   If MK=8 Then For I=1 To Len(ANT$(8)) : SH[353,28+I*15,Mid$(ANT$(8),I,1),2,1] : Next I : Paste Icon 344,18,1
   If MK=9 Then For I=1 To Len(ANT$(9)) : SH[383,28+I*15,Mid$(ANT$(9),I,1),2,1] : Next I : Paste Icon 374,18,1
   If MK=10 Then For I=1 To Len(ANT$(10)) : SH[23+I*30,43,Mid$(ANT$(10),I,1),2,1] : Next I : Paste Icon 14,33,1
   If MK=11 Then For I=1 To Len(ANT$(11)) : SH[203+I*30,43,Mid$(ANT$(11),I,1),2,1] : Next I : Paste Icon 194,33,1
   If MK=12 Then For I=1 To Len(ANT$(12)) : SH[23+I*30,58,Mid$(ANT$(12),I,1),2,1] : Next I : Paste Icon 14,48,1
   If MK=13 Then For I=1 To Len(ANT$(13)) : SH[203,58+I*15,Mid$(ANT$(13),I,1),2,1] : Next I : Paste Icon 194,48,1
   If MK=14 Then For I=1 To Len(ANT$(14)) : SH[263+I*30,58,Mid$(ANT$(14),I,1),2,1] : Next I : Paste Icon 254,48,1
   If MK=15 Then For I=1 To Len(ANT$(15)) : SH[113,73+I*15,Mid$(ANT$(15),I,1),2,1] : Next I : Paste Icon 104,63,1
   If MK=16 Then For I=1 To Len(ANT$(16)) : SH[173+I*30,73,Mid$(ANT$(16),I,1),2,1] : Next I : Paste Icon 164,63,1
   If MK=17 Then For I=1 To Len(ANT$(17)) : SH[-7+I*30,73,Mid$(ANT$(17),I,1),2,1] : Next I : Paste Icon 14,78,1
   If MK=18 Then For I=1 To Len(ANT$(18)) : SH[83+I*30,88,Mid$(ANT$(18),I,1),2,1] : Next I : Paste Icon 74,78,1
   If MK=19 Then For I=1 To Len(ANT$(19)) : SH[263,88+I*15,Mid$(ANT$(19),I,1),2,1] : Next I : Paste Icon 254,78,1
   If MK=20 Then For I=1 To Len(ANT$(20)) : SH[353,88+I*15,Mid$(ANT$(20),I,1),2,1] : Next I : Paste Icon 344,78,1
   If MK=21 Then For I=1 To Len(ANT$(21)) : SH[173,103+I*15,Mid$(ANT$(21),I,1),2,1] : Next I : Paste Icon 164,93,1
   If MK=22 Then For I=1 To Len(ANT$(22)) : SH[233+I*30,103,Mid$(ANT$(22),I,1),2,1] : Next I : Paste Icon 224,93,1
   If MK=23 Then For I=1 To Len(ANT$(23)) : SH[-7+I*30,103,Mid$(ANT$(23),I,1),2,1] : Next I : Paste Icon 14,108,1
   If MK=24 Then For I=1 To Len(ANT$(24)) : SH[83,118+I*15,Mid$(ANT$(24),I,1),2,1] : Next I : Paste Icon 74,108,1
   If MK=25 Then For I=1 To Len(ANT$(25)) : SH[143,118+I*15,Mid$(ANT$(25),I,1),2,1] : Next I : Paste Icon 134,108,1
   If MK=26 Then For I=1 To Len(ANT$(26)) : SH[233,118+I*15,Mid$(ANT$(26),I,1),2,1] : Next I : Paste Icon 224,108,1
   If MK=27 Then For I=1 To Len(ANT$(27)) : SH[323,118+I*15,Mid$(ANT$(27),I,1),2,1] : Next I : Paste Icon 314,108,1
   If MK=28 Then For I=1 To Len(ANT$(28)) : SH[383,118+I*15,Mid$(ANT$(28),I,1),2,1] : Next I : Paste Icon 374,108,1
   If MK=29 Then For I=1 To Len(ANT$(29)) : SH[23+I*30,133,Mid$(ANT$(29),I,1),2,1] : Next I : Paste Icon 14,123,1
   If MK=30 Then For I=1 To Len(ANT$(30)) : SH[203+I*30,133,Mid$(ANT$(30),I,1),2,1] : Next I : Paste Icon 194,123,1
   If MK=31 Then For I=1 To Len(ANT$(31)) : SH[293+I*30,133,Mid$(ANT$(31),I,1),2,1] : Next I : Paste Icon 284,123,1
   If MK=32 Then For I=1 To Len(ANT$(32)) : SH[113+I*30,148,Mid$(ANT$(32),I,1),2,1] : Next I : Paste Icon 104,138,1
   If MK=33 Then For I=1 To Len(ANT$(33)) : SH[203,148+I*15,Mid$(ANT$(33),I,1),2,1] : Next I : Paste Icon 194,138,1
   If MK=34 Then For I=1 To Len(ANT$(34)) : SH[293+I*30,148,Mid$(ANT$(34),I,1),2,1] : Next I : Paste Icon 284,138,1
   If MK=35 Then For I=1 To Len(ANT$(35)) : SH[-7+I*30,148,Mid$(ANT$(35),I,1),2,1] : Next I : Paste Icon 14,153,1
   If MK=36 Then For I=1 To Len(ANT$(36)) : SH[53,163+I*15,Mid$(ANT$(36),I,1),2,1] : Next I : Paste Icon 44,153,1
   If MK=37 Then For I=1 To Len(ANT$(37)) : SH[113+I*30,163,Mid$(ANT$(37),I,1),2,1] : Next I : Paste Icon 104,153,1
   If MK=38 Then For I=1 To Len(ANT$(38)) : SH[233+I*30,163,Mid$(ANT$(38),I,1),2,1] : Next I : Paste Icon 224,153,1
   If MK=39 Then For I=1 To Len(ANT$(39)) : SH[23+I*30,178,Mid$(ANT$(39),I,1),2,1] : Next I : Paste Icon 14,168,1
   If MK=40 Then For I=1 To Len(ANT$(40)) : SH[113+I*30,178,Mid$(ANT$(40),I,1),2,1] : Next I : Paste Icon 104,168,1
   If MK=41 Then For I=1 To Len(ANT$(41)) : SH[233,178+I*15,Mid$(ANT$(41),I,1),2,1] : Next I : Paste Icon 224,168,1
   If MK=42 Then For I=1 To Len(ANT$(42)) : SH[293,178+I*15,Mid$(ANT$(42),I,1),2,1] : Next I : Paste Icon 284,168,1
   If MK=43 Then For I=1 To Len(ANT$(43)) : SH[353,178+I*15,Mid$(ANT$(43),I,1),2,1] : Next I : Paste Icon 344,168,1
   If MK=44 Then For I=1 To Len(ANT$(44)) : SH[113,193+I*15,Mid$(ANT$(44),I,1),2,1] : Next I : Paste Icon 104,183,1
   If MK=45 Then For I=1 To Len(ANT$(45)) : SH[203,193+I*15,Mid$(ANT$(45),I,1),2,1] : Next I : Paste Icon 194,183,1
   If MK=46 Then For I=1 To Len(ANT$(46)) : SH[263+I*30,193,Mid$(ANT$(46),I,1),2,1] : Next I : Paste Icon 254,183,1
   If MK=47 Then For I=1 To Len(ANT$(47)) : SH[-7+I*30,193,Mid$(ANT$(47),I,1),2,1] : Next I : Paste Icon 14,198,1
   If MK=48 Then For I=1 To Len(ANT$(48)) : SH[83,208+I*15,Mid$(ANT$(48),I,1),2,1] : Next I : Paste Icon 74,198,1
   If MK=49 Then For I=1 To Len(ANT$(49)) : SH[173+I*30,208,Mid$(ANT$(49),I,1),2,1] : Next I : Paste Icon 164,198,1
   If MK=50 Then For I=1 To Len(ANT$(50)) : SH[323,208+I*15,Mid$(ANT$(50),I,1),2,1] : Next I : Paste Icon 314,198,1
   If MK=51 Then For I=1 To Len(ANT$(51)) : SH[173+I*30,223,Mid$(ANT$(51),I,1),2,1] : Next I : Paste Icon 164,213,1
   If MK=52 Then For I=1 To Len(ANT$(52)) : SH[263+I*30,223,Mid$(ANT$(52),I,1),2,1] : Next I : Paste Icon 254,213,1
   If MK=53 Then For I=1 To Len(ANT$(53)) : SH[-7+I*30,223,Mid$(ANT$(53),I,1),2,1] : Next I : Paste Icon 14,228,1
   If MK=54 Then For I=1 To Len(ANT$(54)) : SH[143+I*30,238,Mid$(ANT$(54),I,1),2,1] : Next I : Paste Icon 134,228,1
   Add FRAGE,-1
   Cls 4,582,137 To 614,149
   FR$=Str$(FRAGE)-" "
   FR$=String$("0",2-Len(FR$))+FR$
   SH[590,146,FR$,2,1]
   Add GEL,1
End Proc
Procedure CLEAR
   '
   If CL=1
      Cls 4,410,197 To 635,210
      SH[465,206,MESS$(4),2,1]
      CL=0
      Wait 100
      Cls 4,410,197 To 635,210
      Cls 4,410,227 To 635,240
      SH[415,206,MESS$(2),2,1]
   End If 
   If CL=2
      Cls 4,410,197 To 635,210
      SH[460,206,MESS$(3),2,1]
      Wait 100
      Cls 4,410,197 To 635,210
      SH[415,206,MESS$(2),2,1]
      Cls 4,410,227 To 635,240
      CL=0
   End If 
   Cls 4,410,167 To 636,180
End Proc
Procedure NEUES_SPIEL
   '
   Ink 1
   Bar 10,130 To 639,149
   Ink 0
   Bar 4,127 To 633,146
   Ink 5
   Box 4,127 To 633,146
   SH[30,139,MESS$(8),2,1]
   CTR$=Input$(1)
   If CTR$=Chr$(110)
      Ink 0
      For I=1 To 320
         Draw 321-I,0 To 321-I,250
         Draw 319+I,0 To 319+I,250
      Next I
      For T=1 To Len(MESS$(10))
         SH[90+T*10,128,Mid$(MESS$(10),T,1),2,1]
         SH[90+T*10,138,Mid$(String$("-",Len(MESS$(10))),T,1),2,1]
         Wait 2
      Next T
      Play 65,0
      Wait 100 : Fade 3 : Wait 45
      Screen Close 0
      End 
   End If 
   If CTR$=Chr$(106)
      Goto WEITER
   End If 
   WEITER:
   Fade 3 : Wait 45
   Screen Close 0
   Wait 5
   Unpack 10 To 0
   Hide On 
   Screen Display 0,,300,,
   For Y=300 To 40 Step -4
      Screen Display 0,,Y,,
      Wait Vbl 
   Next Y
   Flash 3,"(f00,25)(ff0,25)"
   Gr Writing 0
   Paper 4 : Pen 2
   GEL=0
   INIT_1
End Proc
Procedure NUMBER
   '
   NB$=Str$(MK)-" "
   NB$=String$("0",2-Len(NB$))+NB$
   Cls 4,410,167 To 636,180
   SH[415,176,MESS$(1)+"  "+NB$,2,1]
End Proc
Procedure AUFLOESUNG
   '
   Get Block 1,0,0,640,256
   Colour 0,$0
   Colour Back 0
   Ink 0
   Bar 0,0 To 640,256
   '
   For T=1 To 18
      T$=Str$(T)-" "
      T$=String$(" ",2-Len(T$))+T$
      '
      SH[50,16+T*10,T$+" "+ANT$(T),2,4]
   Next T
   For T=19 To 36
      T$=Str$(T)-" "
      T$=String$(" ",2-Len(T$))+T$
      '
      SH[250,-164+T*10,T$+" "+ANT$(T),2,4]
   Next T
   For T=37 To 54
      T$=Str$(T)-" "
      T$=String$(" ",2-Len(T$))+T$
      '
      SH[450,-344+T*10,T$+" "+ANT$(T),2,4]
   Next T
   SH[10,213,String$("~",77),2,4]
   SH[30,225,MESS$(12)+Space$(2)+EING$+Space$(6)+MESS$(13),2,4]
   SH[10,243,String$("~",77),2,4]
   '
   Repeat 
      L$=Inkey$
   Until L$=Chr$(27)
   Put Block 1
   Colour 0,$8B
End Proc
Procedure SH[X,Y,B$,F,B]
   Ink B
   Text X+2,Y+1,B$
   Ink F
   Text X,Y,B$
End Proc

