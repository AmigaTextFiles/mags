<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>
<HEAD>
	<TITLE>AmigaScene 0x05 - Special</TITLE>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML;CHARSET=iso8859-1">
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#101010" LINK="#BF0000" VLINK="#101010" ALINK="#E04040">
	<TABLE WIDTH="100%" CELLPADDING=3 CELLSPACING=0 BORDER=0>
		<TR>
			<TD BGCOLOR="#FFFFFF" VALIGN=TOP WIDTH="80%" HEIGHT=75>
				<A NAME="00" HREF="welcome.html"><IMG SRC="../images/_amiga.gif" WIDTH=125 HEIGHT=48 ALT="[Amiga]" ALIGN=RIGHT BORDER=0></A><A HREF="#99"><IMG SRC="../images/_krumm_lo.gif" WIDTH=37 HEIGHT=29 ALT="[Down]" ALIGN=LEFT BORDER=0></A>
				<BR CLEAR=ALL><BR>
				<TABLE ALIGN=CENTER WIDTH=170 BORDER=0 CELLSPACING=0 CELLPADDING=0><TR><TD ALIGN=CENTER>
					<A HREF="../deutsch/0x007E.html"><IMG WIDTH=16 HEIGHT=10 SRC="../images/__german.gif" ALT="[ german ]" BORDER=1></A>
				</TD></TR></TABLE>
 			</TD>
			<TD BGCOLOR="#BF0000" VALIGN=TOP ALIGN=RIGHT WIDTH=175>
				<A HREF="welcome.html"><IMG SRC="../images/_scene.gif" WIDTH=110 HEIGHT=47 ALT="[Scene]" ALIGN=LEFT BORDER=0></A>
				<A HREF="0x007D.html"><IMG SRC="../images/_gerade_li.gif" WIDTH=22 HEIGHT=41 ALT="{" BORDER=0></A><A HREF="0x007F.html"><IMG SRC="../images/_gerade_re.gif" WIDTH=23 HEIGHT=41 ALT="}" BORDER=0></A>
			</TD>
		</TR>
		<TR>
			<TD BGCOLOR="#FFFFFF" VALIGN=MIDDLE ALIGN=CENTER>
				<CENTER>&nbsp;<BR>

					<IMG WIDTH=100 HEIGHT=25 SRC="../images/_special_.gif" ALT="[Special]">&nbsp;<BR><BR>

					<TABLE WIDTH="90%" BORDER=0>
						<TR><TD ALIGN=CENTER><FONT SIZE="-1">

| <A HREF="0x007E.html">Commodities</A> |

						</FONT></TD></TR>
					</TABLE>&nbsp;<BR>
				</CENTER>
			</TD>
			<TD BGCOLOR="#BF0000" VALIGN=TOP ALIGN=CENTER WIDTH=175 ROWSPAN=2>
				<CENTER>&nbsp;<BR>
					<IMG SRC="../images/__.gif" HEIGHT=1 WIDTH=175 ALT=" "><BR> 
					<A HREF="0x006F.html"><IMG WIDTH=77  HEIGHT=25 SRC="../images/_cover.gif"     ALT="[Cover]"     BORDER=0></A><BR>
					<A HREF="0x0070.html"><IMG WIDTH=117 HEIGHT=25 SRC="../images/_editorial.gif" ALT="[Editorial]" BORDER=0></A><BR>
					<A HREF="0x0071.html"><IMG WIDTH=85  HEIGHT=25 SRC="../images/_inhalt.gif"    ALT="[Inhalt]"    BORDER=0></A><BR>
					<A HREF="0x0072.html"><IMG WIDTH=70  HEIGHT=25 SRC="../images/_news.gif"      ALT="[News]"      BORDER=0></A><BR>
					<A HREF="0x0073.html"><IMG WIDTH=131 HEIGHT=25 SRC="../images/_hardware.gif"  ALT="[Hardware]"  BORDER=0></A><BR>
					<A HREF="0x0074.html"><IMG WIDTH=121 HEIGHT=25 SRC="../images/_software.gif"  ALT="[Software]"  BORDER=0></A><BR>
					<A HREF="0x0078.html"><IMG WIDTH=135 HEIGHT=25 SRC="../images/_workshop.gif"  ALT="[Workshop]"  BORDER=0></A><BR>
					<A HREF="0x007D.html"><IMG WIDTH=73  HEIGHT=25 SRC="../images/_spiele.gif"    ALT="[Spiele]"    BORDER=0></A><BR>
					<A HREF="0x007E.html"><IMG WIDTH=91  HEIGHT=25 SRC="../images/_special.gif"   ALT="[Special]"   BORDER=0></A><BR>
					<A HREF="0x007F.html"><IMG WIDTH=112 HEIGHT=25 SRC="../images/_feedback.gif"  ALT="[Feedback]"  BORDER=0></A><BR>
					<A HREF="0x0080.html"><IMG WIDTH=46  HEIGHT=25 SRC="../images/_etc.gif"       ALT="[Etc]"       BORDER=0></A><BR>
				<BR></CENTER>
			</TD>
		</TR>
		<TR>
			<TD BGCOLOR="#FFFFFF" VALIGN=TOP ALIGN=LEFT>

<BR><H1 ALIGN=LEFT><FONT FACE="Arial"><B>Commodities - Technischer Hintergrund</B></FONT></H1>&nbsp;

<BR><FONT SIZE="+1">Die mit der Betriebssystemversion 2.0 eingef&uuml;hrten
Commodities Exchange Funktionen sind die Grundlage f&uuml;r die auf dem
Amiga gleichfalls n&uuml;tzlichen und beliebten Commodities, welche einen
der vielen Gr&uuml;nde darstellen, warum sich unsere Rechner gegen&uuml;ber
anderen System so flexibel und anpassungsf&auml;hig darstellen. </FONT><BR>

<BR><CENTER><A NAME="01" HREF="#00"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_li.gif" ALT=" " BORDER=0></A><A HREF="#02"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_re.gif" ALT=" " BORDER=0></A></CENTER>&nbsp;

<BR>Dabei erm&ouml;glichen Commodities nicht einmal etwas grundlegend neues,
was nicht auch schon unter den &auml;lteren Betriebssystemversionen 1.2 und
1.3 m&ouml;glich gewesen w&auml;re. Es handelt sich n&auml;mlich um
Programme, die auf sogenannte Input-Events reagieren. Diese Input-Events
werden vom input.device des Betriebssystems generiert, welches bei fast
allen Benutzereingaben seine Hand im Spiel hat. Sie stellen eine
Konzentration von Tastatur-, Maus- und anderen Ereignissen dar und werden
vom input.device nacheinander an verschiedene Input-Handler weitergeleitet.
Standardm&auml;&szlig;ig haben z.B. Intuition und das console.device hier
Input-Handler eingeh&auml;ngt, damit sie diese Ereignisse mitbekommen.
Jedoch ist es schon seit jeher m&ouml;glich, eigene Input-Handler zu
installieren und damit ebenfalls &uuml;ber die Benutzeraktionen informiert
zu sein. Au&szlig;erdem k&ouml;nnen solche Input-Handler selbst
Input-Events generieren oder welche ver&auml;ndern. Damit war
grunds&auml;tzlich alles m&ouml;glich, was heute mit den Commodities
gemacht wird. Jedoch zeigte sich, da&szlig; die Input-Handler einerseits
schwierig zu schreiben waren und sie sich andererseits leicht gegenseitig
st&ouml;ren konnten oder die Reihenfolge, in welcher diese aktiviert
werden, entscheidend ist.<BR>

<BR><CENTER><A NAME="02" HREF="#01"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_li.gif" ALT=" " BORDER=0></A><A HREF="#03"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_re.gif" ALT=" " BORDER=0></A></CENTER>&nbsp;

<BR>Um diesen Umstand zu beseitigen, wurde damals von Commodore die
Commodities Exchange Library entwickelt, welche Funktionen bereitstellt,
die es erm&ouml;glichen, da&szlig; sich eine Vielzahl von Programmen, sog.
Commodities, geordnet in den Input-Strom einh&auml;ngen k&ouml;nnen, ohne
sich gegenseitig zu st&ouml;ren. Dazu wurde auch das
Commodity-Exchange-Programm entwickelt, welches sich im Verzeichnis
Tools/Commodities der Systemplatte befindet und mit dem die aktivierten
Commodities kontrolliert werden k&ouml;nnen.<BR>

<BR>Die commodities.library h&auml;ngt selbst einen Input-Handler noch vor
dem Input-Handler von Intuition beim input.device ein, um alle Input-Events
mitzubekommen. Der Benutzer dieser Library, also der Autor eines
Commodity-Programms braucht jetzt jedoch nicht mehr direkt einen
Input-Handler zu schreiben, sondern verwendet sogenannte Commodity Exchange
Objects, im weiteren kurz als CxObjects bezeichnet. Wenn der Input-Handler
der commodity.library Input-Events empf&auml;ngt, dann erzeugt er
zugeh&ouml;rige CxMessages (Commodity Exchange Messages) welche er an das
Nezwerk von CxObjects weiterleitet.<BR>

<BR><CENTER><A NAME="03" HREF="#02"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_li.gif" ALT=" " BORDER=0></A><A HREF="#04"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_re.gif" ALT=" " BORDER=0></A></CENTER>&nbsp;

<BR>Derzeit gibt es sieben verschiedene Arten von CxObjects, wovon jede
eine andere Art der Behandlung von CxMessages durchf&uuml;hrt:<BR>

<BR><TABLE BORDER=4 BGCOLOR="#EEEEEE" CELLPADDING=3 CELLSPACING=0 ALIGN=CENTER>
<TR VALIGN=TOP>
<TD><B>CxObject-Typ</B></TD>
<TD><B>Verwendung</B></TD>
</TR>
<TR VALIGN=TOP>
<TD>Broker</TD>
<TD>Zum Anmelden eines Commodity zum Commodity-Netzwerk</TD>
</TR>
<TR VALIGN=TOP>
<TD>Filter</TD>
<TD>Akzeptiert oder verwirft Input-Events</TD>
</TR>
<TR VALIGN=TOP>
<TD>Sender</TD>
<TD>Sendet eine Message an einen Message-Port</TD>
</TR>
<TR VALIGN=TOP>
<TD>Translate</TD>
<TD>Ersetzt ein Input-Event durch ein anderes</TD>
</TR>
<TR VALIGN=TOP>
<TD>Signal</TD>
<TD>Signalisiert einen Task</TD>
</TR>
<TR VALIGN=TOP>
<TD>Custom</TD>
<TD>Ruft eine benutzerspezifizierte Funktion auf</TD>
</TR>
<TR VALIGN=TOP>
<TD>Debug</TD>
<TD>Schreibt Debug-Ausgaben &uuml;ber die serielle Schnittstelle</TD>
</TR>
</TABLE>&nbsp;

<BR><CENTER><A NAME="04" HREF="#03"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_li.gif" ALT=" " BORDER=0></A><A HREF="#05"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_re.gif" ALT=" " BORDER=0></A></CENTER>&nbsp;

<BR>Diese CxObjects werden zu B&auml;umen zusammengeh&auml;ngt, um das
Verhalten zu definieren. Dabei k&ouml;nnen einem CxObject andere zugeordnet
werden, welche alle CxMessages, die vom &uuml;bergeordneten Objekt nicht
eliminiert wurden, nacheinander empfangen.<BR>

<BR>Mit dem Broker-Objekt zapft man den Strom der CxMessages an und wird
auch &uuml;ber das Commodity-Exchange-Programm steuerbar. Andere CxObjectes
werden dann zum Broker hinzugef&uuml;gt. &Uuml;blicherweise h&auml;ngt man
ein Filter-Object hinzu, um die Events, auf die man reagieren will,
herauszufiltern und alle anderen unber&uuml;cksichtigt zu lassen. Das
Filter-Object l&auml;&szlig;t dann nur mehr diese CxMessages, welche den
Filterbedingungen gen&uuml;gen, durch. Das bedeutet, alle CxObjects, welche
beim Filter-Object eingeh&auml;ngt werden, erhalten nur die gefilterten
CxMessages. Dies ist wichtig, da die anderen CxObjects ihre Aktion
unabh&auml;ngig von der einlangenden CxMessage durchf&uuml;hren.<BR>

<BR><CENTER><A NAME="05" HREF="#04"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_li.gif" ALT=" " BORDER=0></A><A HREF="#06"><IMG WIDTH=13 HEIGHT=26 SRC="../images/_schraeg_re.gif" ALT=" " BORDER=0></A></CENTER>&nbsp;

<BR>Ein &uuml;blicher Vorgang um z.B. auf eine Tastenkombination zu
reagieren kann durch folgende Objektstruktur erreicht werden:<BR>

<BR>Man erzeugt ein Broker-Objekt, in welches man ein Filter-Objekt
einh&auml;ngt. Dem Filter-Objekt gibt man die Tastenkombination, auf die
man reagieren will, als Filterbedingung mit. In dieses Filter-Objekt
h&auml;ngt man dann ein Sender-Objekt, welches eine Nachricht
bez&uuml;glich der eingelangten CxMessage an einen von uns anzugebenden
Message-Port schickt. Dies ist &uuml;blicherweise ein Message-Port unseres
Commodity-Programms. Wenn die Message dort ankommt, dann f&uuml;hren wir
die mit der Tastenkombination verkn&uuml;pfte Aktion aus.<BR>

<BR>Damit die urspr&uuml;ngliche Intuition-Message, welche der
Tastenkombination entspricht, eliminiert wird, h&auml;ngen wir auch noch
ein Translate-Objekt ans Ende der Objektliste unseres Filter-Objektes ein.
Mit so einem Translate-Objekt kann man Input-Events ver&auml;ndern aber,
was f&uuml;r unseren Fall interessant ist, auch eliminieren.<BR>

<BR>In diesem Beispiel wird die eigentliche Arbeit nicht von den CxObjects
gemacht, sondern von unserem Commodity-Programm aufgrund der Messages, die
uns vom Sender-Object geschickt werden.<BR>

<BR>So viel zum grundlegenden technischen Aufbau von Commodities.<BR>

			<BR>
			</TD>
		</TR>
		<TR>
			<TD BGCOLOR="#FFFFFF" VALIGN=TOP ALIGN=LEFT>
				<P ALIGN=RIGHT>

					<A HREF="as-redax.html#thomas">Thomas &Ouml;llinger</A>
					&nbsp;&nbsp;&nbsp;
					<A HREF="../deutsch/0x007E.html"><IMG WIDTH=16 HEIGHT=10 SRC="../images/__german.gif" ALT="[ german ]" VSPACE=0 HSPACE=0 BORDER=1></A>
					&nbsp;&nbsp;&nbsp;
					<BR>

				</P>
			</TD>
			<TD BGCOLOR="#BF0000" VALIGN=TOP ALIGN=CENTER> &nbsp;
			</TD>
		</TR>
		<TR>
			<TD BGCOLOR="#FFFFFF" VALIGN=MIDDLE ALIGN=LEFT>
				<A HREF="#00"><IMG SRC="../images/_krumm_hi.gif" WIDTH=37 HEIGHT=29 BORDER=0 ALT="[Up]"></A>
				<A NAME="99"><FONT COLOR="#FFFFFF">&nbsp;</FONT></A>
			</TD>
			<TD BGCOLOR="#BF0000" VALIGN=BOTTOM ALIGN=RIGHT>
				<A HREF="0x007D.html"><IMG SRC="../images/_gerade_li.gif" WIDTH=22 HEIGHT=41 ALT="{" BORDER=0></A><A HREF="0x007F.html"><IMG SRC="../images/_gerade_re.gif" WIDTH=23 HEIGHT=41 ALT="}" BORDER=0></A>
			</TD>
		</TR>
	</TABLE>
</BODY>
</HTML>
