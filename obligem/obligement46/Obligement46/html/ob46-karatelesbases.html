<html>
 <head>
  <title>Karate - les bases</title>
  <meta name="author" CONTENT="David Brunet obligement@free.fr">
 </head>

<body bgcolor="#000000" text="#cccccc" link="#cccc33" vlink="#aaaa22" alink="#cccccc" marginheight="0" marginwidth="0" topmargin="5" leftmargin="0">

<a name="top">

<map name="ObMap">
  <area shape="rect" coords="0,0,760,82" href="http://obligement.free.fr">
  <area shape="rect" coords="8,87,62,104" href="../index.html" alt="Intro">
  <area shape="rect" coords="80,87,168,104" href="edito.html" alt="Editorial">
  <area shape="rect" coords="186,87,278,104" href="apropos.html" alt="A Propos">
  <area shape="rect" coords="296,87,399,104" href="sommaire.html" alt="Sommaire">
  <area shape="rect" coords="414,87,473,104" href="quizz.html" alt="Quizz">
  <area shape="rect" coords="491,87,589,104" href="musiques.html" alt="Musiques">
  <area shape="rect" coords="607,87,648,104" href="pub.html" alt="Pub">
  <area shape="rect" coords="666,87,756,104" href="archives.html" alt="Archives">
</map>

<table align="center" valign="top" width="760" height="100%" background="../gfx/fondsommaire.jpg" bgcolor="#112233" cellspacing="0" cellpadding="0">
 <tr align="top">
  <td align="center">
   <img src="../gfx/oblogo.jpg" ismap usemap="#ObMap" border="0" height="108" width="760" alt="Obligement">

   <br><br><br>
   <table align="center" width="75%">
    <tr>
     <td>

<div align="center"><font size="+3">En pratique&nbsp;: Karate - les bases </font>par&nbsp;<a href="mailto:l.stephanoni@free.fr">Laurent&nbsp;Stephanoni</a></div><br><br><br>


<font size="+1" color="#ccbb33">1. Introduction</font><br><br>

<font size="+1" color="#ccbb33">1.1 Karate, c'est quoi&nbsp;?</font><br><br>

C'est un système de création multimédia basé sur des scripts
ressemblant à du XML. A tout ceux à qui le XML fait peur, on va dire que c'est
basé sur un langage de balise, comme le HTML, mais en plus simple. Si on fait
encore peur à des gens, on va dire qu'on a pas besoin de connaître quoi que
ce soit pour faire du Karate. Rassurés&nbsp;?<br><br>

Ça consiste en un exécutable (appelé Karate) qui va comprendre les scripts
(on dit "interpréter" quand on veut briller devant ses amis) et des modules d'effets
(les &lt;Fx&gt;), qui se trouvent dans le répertoire "Fx" situé dans le même
répertoire que l'exécutable.<br><br>

<font size="+1" color="#ccbb33">1.2 La panoplie du Karateka</font><br><br>

Déjà, il vous faut un bon éditeur de texte. Eh oui, pour l'instant Karate
n'a pas d'interface d'aide à la création (à quand un StormKarate ou un
KarateBuilder&nbsp;?). Donc, CygnusED ou GoldED feront très
bien l'affaire, mais si vous n'avez qu'EditPad sous la main, ça suffira.<br><br>

Ensuite, il vous faudra des outils de manipulations graphiques.
Là, chacun ses préférences, mais comme Karate ne manipule que des images 8 bits
(256 couleurs), <a href="ftp://de.aminet.net/pub/aminet/biz/cloan/PPaint.lha">Personnal Paint</a> et Deluxe Paint
conviendront parfaitement.<br><br>

Enfin, si vous souhaitez mettre des bruitages/musiques dans votre présentation multimédia,
il vous faudra DigiBooster ou un tracker qui puissent sauver au format The Player
6.1 (p61). Dans le premier cas, il vous faudra la librairie dbplayer.library, en
version 2.0 pour que Karate puisse relire vos créations sonores.
Dans le deuxième cas, cherchez bien, il n'y en a pas, mais il existe
sur <a href="http://ftp.uni-paderborn.de/aminet" target="_blank">Aminet</a> un outil de conversion
Protracker vers p61.<br><br>

Dernière étape, la plus importante, récupérez la dernière version de Karate
disponible sur son site dédié&nbsp;: <a href="http://k-fighter.net/">k-fighter.net/</a>.<br><br>


<font size="+1" color="#ccbb33">1.3 It's showtime&nbsp;!</font><br><br>

Comment exécuter une présentation Karate&nbsp;?
Tout d'abord, il faut que Karate soit correctement installé, c'est-à-dire
que son répertoire "Fx" soit à côté de lui.
Ensuite, il faut passer en ligne de commande, se placer dans le répertoire
de Karate, et taper&nbsp;: "Karate s=chemin/vers/votre/script".<br><br>

Avec cette ligne de commande, Karate va vous demandez le mode d'écran à
utiliser. Si vous voulez le fixer, vous pouvez lui donner la taille 
à utiliser, avec les paramètres h (pour height, hauteur) et w (pour
width, largeur), comme ceci&nbsp;: "Karate s=chemin/vers/votre/script w=320 h=256".
(pour avoir, dans ce cas un écran de 320 par 256).<br><br>

<b>Astuce&nbsp;:</b> pour tester rapidement vos scripts, il existe un mode écran en
320x128 qui permet d'afficher rapidement le résultat de vos
expérimentations.<br><br>

Et pour quitter, vous pouvez pressez la touche Esc à tout moment.<br><br>

<b>Astuce&nbsp;:</b> pour connaître les secrets de Karate, vous pouvez essayer la
commande suivante, toujours dans un shell&nbsp;: "Karate c".<br>
Cette commande lance le mode diagnostic de Karate. Il va ainsi vous faire
passer sur la sortie standard tout les objets, commandes, effets qu'il
connaît, avec leurs paramètres. Pour sauvegarder ce mini-manuel (même les
effets non documentés&nbsp;:) vous pouvez faire&nbsp;: "Karate c &gt;commands.txt".<br>
Cela va vous créer un fichier commands.txt qui contient toutes les
commandes de Karate.<br><br>


<font size="+1" color="#ccbb33">2. La structure d'une présentation Karate</font><br><br>

<font size="+1" color="#ccbb33">2.1 Mainkscriptkpartfxpa</font><br><br>

Karate met en scène des objets, sur lesquels il effectue des effets (Fx).
Un effet est modulé par toute une série de paramètres (Pa). Tous les effets
joués en même temps sont dans une partie (KPart). Un script (KScript)
donne l'enchaînement des parties pour montrer une présentation complète.
Enfin, chaque présentation présente un script principal (Main).<br><br>

Chaque bloc KPart ou KScript peut se trouver n'importe où dans le script,
il n'y a aucun ordre imposé.<br><br>


<font size="+1" color="#ccbb33">2.2 La KPart</font><br><br>

Concrètement, on crée une partie en posant les lignes suivantes&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;KPART&gt;
 &lt;ID&gt; nom_partie &lt;/ID&gt;
 &lt;FX&gt;
  &lt;PA&gt; nom_effet &lt;/PA&gt;
  &lt;PA&gt; ... &lt;/PA&gt;
  ...
 &lt;/FX&gt;

 &lt;FX&gt;...
 &lt;/FX&gt;
&lt;/KPART&gt;
</pre>
</font></td></tr></table>
<br>

On peut créer autant de KPart que l'on veut tant que leur ID sont uniques.<br><br>


<font size="+1" color="#ccbb33">2.3 Et le KScript, tu sais ce qu'il te dit le KScript&nbsp;?</font><br><br>

Puis, on crée un script en posant les lignes suivantes&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;/KSCRIPT&gt;
 &lt;ID&gt; nom_script &lt;/ID&gt;

 &lt;PLAY&gt; nom_partie_1 | nb_frames | frame_de_début | vitesse &lt;/PLAY&gt;
 &lt;PLAY&gt; nom_partie_2 | nb_frames | frame_de_début | vitesse &lt;/PLAY&gt;
 &lt;PLAY&gt; nom_partie_3 | nb_frames | frame_de_début | vitesse &lt;/PLAY&gt;
 ...
 &lt;PLAY&gt; nom_partie_x | nb_frames | frame_de_début | vitesse &lt;/PLAY&gt;
&lt;/KSCRIPT&gt;
</pre>
</font></td></tr></table>
<br>

Le paramètre "nb_frames" de &lt;PLAY&gt; indique à Karate pendant combien de temps
il doit jouer la scène nom_partie_x. Pour savoir pendant combien de frames
faire jouer votre partie, multipliez le nombre de secondes à jouer par 50
(sauf si vous jouez avec la vitesse, auquel cas il faut multiplier par 50
la vitesse).<br><br>

Le deuxième paramètre, "frame_de_début", permet d'indiquer à Karate qu'il
doit sauter un certain nombre de frame et commencer directement à la frame
indiquée. Cela permet de reprendre une scène là où on l'avait laissée. On
laissera à 0 la plupart du temps.<br><br>

Le dernier paramètre, "vitesse", indique à quelle vitesse Karate doit aller.
On met souvent 1, mais si on veut que Karate ne joue qu'une frame sur deux,
on donnera 2, et ainsi de suite. Cela permet d'accélérer les effets sans
avoir à tout modifier les paramètres.<br><br>

<b>Astuce&nbsp;:</b> cela permet aussi de faire jouer un effet à l'envers.
Par exemple, la ligne...<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
 &lt;PLAY&gt; partie | 500 | 1000 | -1 &lt;/PLAY&gt;
</pre>
</font></td></tr></table>
<br>

...fera jouer la partie "partie" pendant 500 frames, en commençant à la
1000e frame, et en reculant. On ira progressivment de la 1000e à la
500e frame.<br><br>

On peut aussi créer autant de Kscript que l'on veut.<br><br>

<font size="+1" color="#ccbb33">2.4 Main</font><br><br>

Et enfin, chaque présentation contiendra la ligne&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;MAIN&gt; mon_script_principal | frame_debut | vitesse &lt;/MAIN&gt;
</pre>
</font></td></tr></table>
<br>

La plupart du temps, on laissera "frame_debut" à 0 et vitesse à 1.<br><br>

<font size="+1" color="#ccbb33">3. Les KObjets</font><br><br>

<font size="+1" color="#ccbb33">3.1 C'est un formidable objet, au prix imbattable de 595 Francs&nbsp;!</font><br><br>

Pour que votre présentation ait des trucs à montrer, il lui faut des
objets. Un objet Karate se reconnaît car il est entre deux balises
&lt;Ktruc&gt;...&lt;/Ktruc&gt; avec un
truc qui peut prendre la valeur image, table, DBM (module digibooster), etc.
Un objet Karate peut être défini n'importe où à l'intérieur du script, et
être utilisé n'importe où à l'intérieur de ce même script (même avant sa
définition). Chaque objet, lors de sa création, se voit baptiser d'un nom qui
devra être unique. C'est ce nom qui servira durant tout le script à appeler l'objet
ainsi créé.<br><br>

On va maintenant détailler quelques KObjets.<br><br>

<font size="+1" color="#ccbb33">3.2 Les images &lt;KIMG&gt;</font><br><br>

Karate peut charger n'importe quel format d'image supporté par les
datatypes. Quand il charge une image, il charge aussi sa palette.<br>

<ul>
<li>Les images Karate ont quatre utilisations principales.
<li>Les images "plain"&nbsp;: l'image telle qu'elle apparait sous DPaint ou PPaint.
<li>Les sprites&nbsp;: la même chose, mais avec la couleur 0 transparente.
<li>Les textures&nbsp;: une texture est une image de 256x256. Suivant le type de
mapping choisit, la couleur 0 pourra ou non être transparente.
<li>Les images "light"&nbsp;: il s'agit d'images en dégradé de gris de 64 couleurs.
</ul>

Grâce à la magie Karate, ces images pourront être utilisées pour créer des
effets de lumière (d'où le light), en devenant plus ou moins claire ou
sombre.<br><br>

Pour charger une image, une seule méthode, quelque soit le type d'image&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;KIMG&gt; nom_image | disk:chemin/image.truc &lt;/KIMG&gt;
</pre>
</font></td></tr></table>
<br>


Attention, le chemin doit être donné en absolu (disk:...) ou en relatif
depuis le répertoire de Karate, mais pas depuis le répertoire de votre script.<br><br>

<b>Astuce&nbsp;:</b> quand vous distribuerez vos démos, distribuez toujours une démo
sous la forme "un répertoire (avec toutes vos données et votre fichier
Karate) + un script shell de lancement", avec comme instruction de tout
copier, sous cette forme, dans le répertoire de Karate.
Ainsi, vous serez donc sûrs que vos données seront au bon endroit en
indiquant comme chemin MonRépertoire/MonImage.iff ou
MonRépertoire/MonModule.dbm.<br><br>

Le script shell prendra la forme suivante&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
; Start Ma Demo
karate s=MonRépertoire/MonScript.k
</pre>
</font></td></tr></table>
<br>

N'oubliez pas de protéger le script pour qu'il soit lançable directement
en faisant, dans un shell, un "protect MonScriptShell s add".<br><br>


<font size="+1" color="#ccbb33">3.3 Les modules DBM &lt;KDBM&gt;</font><br><br>

Karate peut charger n'importe quel module DBM, gràce à l'instruction
suivante&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;KDBM&gt; nom_dbm | disk:chemin/module.dbm &lt;/KDBM&gt;
</pre>
</font></td></tr></table>
<br>

Idem pour les modules p61, mais avec&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;KP61&gt; nom_p61 | disk:chemin/module.p61 &lt;/KP61&gt;
</pre>
</font></td></tr></table>
<br>


<font size="+1" color="#ccbb33">3.4 les tables &lt;KTABLE&gt;</font><br><br>

Ensuite, bien que Karate viennent avec plein de fonctions mathématiques
qui font mal à la tête des étudiants (cos, sin, cost, sint...), on pourra
avoir envie de créer sa propre fonction mathématique. Comment&nbsp;? Tout
simplement grâce à une ktable.<br><br>

Une ktable, est une table qui associe à un temps donné, une valeur
réelle (ou un float). On crée ça tout simplement avec&nbsp;:<br><br>

<table border="1" bgcolor="#c0c0c0" width="100%"><tr><td><font color="#000000" size="-1">
<pre>
&lt;KTABLE&gt; nom_table | t0, val0 | t1, val1 | t2, val2 | ....
  .... | tn, valn&lt;/KTABLE&gt;
</pre>
</font></td></tr></table>
<br>

Entre ti et ti+1, la valeur va varier de vali à vali+1, soit
proportionnellement, soit avec un effet d'extrapolation polynomiale (ce
sera plus "naturel"), selon la méthode utilisée.<br><br>

Voilà donc en gros les principales bases à connaître avant de se lancer dans Karate.
Pour les plus courageux/créatifs d'entre vous, vous pouvez passer à l'<a href="ob46-karateexempleconcret.html">article suivant</a>
avec un premier exemple concret.<br><br><br>



<div align="center"><a href="#top">Retour en haut</a> | <a href="sommaire.html">Retour au sommaire</a></div><br><br> 


     </td>
    </tr>
   </table>
  </td>
 </tr>
</table>


</body>
</html>
