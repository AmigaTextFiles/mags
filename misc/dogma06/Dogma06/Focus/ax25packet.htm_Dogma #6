<HTML>
<HEAD>
<TITLE>
Догма - электронное Амижное издание
</TITLE>
<meta http-equiv="content-type" content="text/html; charset=windows-1251">
<BODY TEXT="white" bgcolor="black">
</HEAD>
<script language="JavaScript" src="../topalt.js"></script>
<script language="JavaScript" src="../leftalt.js"></script>

<table BACKGROUND="../GFX/fon.jpg" align="center" width="90%" border="0" cellspacing="0" cellpadding="0" bgcolor="black">
<tr>
<td colspan="3"><font color="white">
<CENTER><BR><font size="+1" color="yellow"><b>Пакетное радио на Amiga</b></font><BR>
<font size="-1" color="white">Автор -=\<font size="-1" color="yellow">Владимир Сидоров</font>/=-</font><HR></CENTER>
CB CALL [RUS013] (Частота 27235 кГц)

<p align="center"><font color="yellow">Что такое гражданская радиосвязь ("CB")?</font></p>

<p>"CB" - это сокращение от "Citizen's Band" (англ:  "Гражданский
диапазон").  Это значит, что любой человек может использовать радиосвязь в
диапазоне 27 МГц.  В зависимости от того, в какой стране вы живете,
использование этого диапазона либо минимально урегулировано правилами
проведения локальных связей, либо не урегулировано вовсе.  По своей сути
средства радиосвязи этого диапазона представляют собой носимые, возимые или
стационарные радиостанции.</p>

<p align="center"><font color="yellow">Си-Би и цифровая связь</font></p>

<p>Сразу же необходимо отметить, что цифровые виды связи на гражданском
диапазоне не разрешены действующими правилами:  "4.7.  Радиостанции должны
использоваться только для обмена речевыми сообщениями.  В радиостанциях
категорически запрещается применять устройство шифрования речи (правила
Си-Би связи).  Хотя, цифровая связь - это кодирование информации, а никак
не шифрование, но, тем не менее, всё-таки, не обмен речевыми сообщениями.
Однако, за рубежом цифровая связь на Си-Би диапазоне применяется довольно
широко (несмотря на то, что в большинстве стран это тоже не разрешено...).
Характерные сигналы можно слышать во время дальнего прохождения радиоволн,
в основном, в сетке "B" в однополосной модуляции (преимущественно
используется нижняя боковая полоса - LSB).  На Си-Би, в основном,
применяется пакетная связь (packet radio, PR) с использованием протокола
AX.25 на скоростях 300, 1200, 2400 бит/с и (реже) телевидение с медленной
развёрткой (slow scan TV, SSTV).  Другие виды цифровой связи (RTTY, AMTOR,
PACTOR, CLOVER, ASCII) рассматривать не будем, так как в настоящее время на
Си-Би они применяются крайне редко.  Для работы в PR применяют трансиверы,
как правило, с электронным переключением "приём-передача", контроллер
пакетной радиосвязи (terminal node controller, TNC), функционально
состоящий из радиомодема AFSK и пакетного адаптера протокола AX.25, и
компьютер с необходимым программным обеспечением.  В качестве TNC многие
используют звуковую карту компьютера с соответствующим ПО (FlexNet).
Отличие в том, что "полноценный" TNC может работать и без компьютера, но
только в качестве почтового ящика (personal mail box, PMB) ограниченного
объёма, маяка (beacon) и диджипитера (digipeater) - симплексного цифрового
репитера.</p>

<p>Что позволяет пакетная связь?  Она позволяет организовывать "электронные
доски объявлений" (bulletin board stations, BBS), обмениваться сообщениями
и файлами с ними, а также непосредственно между радиостанциями, в том числе
с использованием промежуточных диджипитеров.  В последнем случае дальность
связи значительно возрастает.  Ведь TNC позволяет использовать до восьми
диджипитеров в связной цепочке.  Правда, скорость передачи данных при этом
падает, но связь, тем не менее, возможна.  Система позывных цифровых
радиостанций несколько отличается от обычной, принятой в мире для
проведения дальних связей.  Первые две-три буквы позывного обозначают,
обычно, страну, остальные буквы и цифры смыслового значения могут и не
нести, например:  FRA281, FRA1ST, FR57MJ (Франция), NOR030 (Норвегия), US1A
(США), POR1PC (Португалия), ESP1PR (Испания), IT4PL (Италия), UK1DUD
(Великобритания).  В конце позывного может добавляться через дефис цифра
(FRA1ST-2), обозначающая, что под таким позывным работает эта же станция,
но с другими функциями.  Например, FRA1ST - обычная радиостанция, FRA1ST-1
- персональный почтовый ящик этой станции, FRA1ST-2 - узел пакетной
радиосети или BBS, и так далее.  Для работы в SSTV в настоящее время
применяется такая же аппаратура, только вместо TNC используется звуковая
карта компьютера и соответствующее программное обеспечение.  SSTV
применяется для передачи неподвижных чёрно-белых и цветных изображений.  На
мой взгляд официальное разрешение органов Госсвязьнадзора на работу
цифровыми видами связи в гражданском диапазоне, хотя бы и в ограниченном
числе каналов, позволило бы решить многие проблемы передачи данных в
регионах с плохо развитой телефонной связью, или при её
неудовлетворительном качестве.</p>

<p>На гражданском диапазоне такого порядка в реальности нет и позывные
придумывают многие как вздумается, или разделяются по своим группам.
Принцип работы в пакете напоминает смесь фидо и интернета.  От фидо взято
наличие ВВS и их принцип работы, от интернета - общение в реальном времени
через ВВS, или терминалки.  У нас в Нижнем Новгороде есть небольшая группа
пакетчиков, состоящая из 4 человек:  трое из города, один из области (30 км
от меня).</p>

<p>Я единственный АМИЖНИК в группе, а может и России; все остальные на РС.
Народа конечно немного, но это только по городу.  На самом деле на радио
полно пакетчиков, но они в основном за границей, так как у них этот вид
связи здорово развит, особенно в Германии и Финляндии (халява, она и есть
халява).</p>

<p>В Германии, например, существует сеть диджипитеров, которая позволяет
находясь на одном диапазоне (канале) соединяться через них с другими
корреспондентами на других диапазонах (каналах).  Существует возможность
гейтовать почту через интернет, а также работать по TCP/IP протоколу и
лазить в интернете, единственное ограничение это скорость и надежность
связи.</p>

<p align="center"><font color="yellow">О железе и софте</font></p>

<p>На своей А1200/Blizzard030@50 я использую терминал AMICOM 2.3 +
BAYCOM-модем.  Модем представляет собой небольшую схемку на отечественных,
или импортных деталях.  Я использую схему из журнала РАДИОЛЮБИТЕЛЬ
N11-96год.  Большой сложности она не представляет, только пришлось
исправлять мелкие погрешности и сделать небольшую доработку в схеме, так
как в драйвере программы не реализована одна в принципе нужная функция -
это программно реализованный DCD (сигнал обнаружения несущей).  Из-за этого
приходится искать достаточно редкую микросхему XR2211, на её основе
реализована аппаратная функция DCD уже в модеме.</p>

<center><img src="../GFX/ax25_pics/modem_bay_ami.gif" alt="Схема модема" border=0></center>

<p>Модем подключается в порт RS232 компьютера и к соответствующим цепям
радиостанции.</p>

<p>Терминальная программа представляет из себя порт аналогичной программы с
UNIX и MS-DOS с несколько расширенными возможностями и наличием GUI.  Кроме
этой программы имеются и другие, более функциональные по своим возможностям
и сервису программы:  это PROFI PACKET, AHP, CBBS и тому подобные, но они
требуют TNC-контроллер, или AMIGATNC программный эмулятор + BAYCOM-модем,
который по каким-то непонятным причинам не хочет полноценно работать, хотя
я всё делал так, как они там рекомендуют, поэтому приходится ограничиваться
терминалкой с внутренним драйвером BAYCOM-модема.</p>

<p align="center"><font color="yellow">Протокол AX.25</font></p>

<p>При осуществлении пакетной связи в радиолюбительском эфире между двумя
или несколькими корреспондентами обмен информацией проводится в
соответствии с некоторым установленным порядком, который называется
протоколом обмена.  При этом используется протокол АХ.25, представляющий
собой переработанную специально для радиолюбительских целей версию
протокола Х.25.  Протоколы обмена содержат семь уровней.  Вся логика
процедуры работы по радиоканалу описывается во втором уровне.  Практически
он реализуется, как правило, специальным контроллером пакетной связи (TNC),
который размещается между компьютером и приемопередатчиком.</p>

<p>Протокол обмена АХ.25 обеспечивает многостанционный (множественный)
доступ в канал связи с контролем занятости.  Все станции считаются
равноправными.  Прежде чем включиться в работу TNC станции проверяет,
свободен или нет канал.  Если занят, то канал проверяется до тех пор, пока
не окажется свободным, и лишь после этого станция включается на передачу.</p>

<p>При пакетной связи сообщения передаются блоками - кадрами.  Кроме
информации, в кадре содержатся данные о назначении кадра, адресах
отправителя, получателя и ретранслятора, через которые должно пройти
сообщение, а также контрольная сумма, позволяющая проверить правильность
принятых кадров.</p>

<p>Формат кадров.  Каждая законченная часть информации представляет собой
кадр.  Он имеет определенный формат.</p>

<p>Каждый кадр начинается с уникальной последовательности бит 01111110,
которая называется флагом и позволяет распознать начало кадра.  Далее идут
адресное поле размером от 14 до 70 байт, управляющее - один байт,
информационное - от 0 до 256 байт, контрольное - 2 байта.</p>

<p>При использовании сетевого, третьего уровня протокола образуется
дополнительное идентификационное поле, которое выступает как часть
информационного поля.  Заканчивается кадр также флагом.</p>

<center><img src="../GFX/ax25_pics/ax25_1.gif" alt="Формат кадров" border=0><br><br>
<img src="../GFX/ax25_pics/ax25_2.gif" alt="Формат адресного поля" border=0></center>

<p>Флаговое поле.  Как уже было отмечено, флаговое поле представляет собой
уникальную последовательность бит 01111110.  Если далее в кадре встретится
такая же последовательность, то для того, чтобы корреспондент ее не принял
за признак окончания пакета, после пятого бита вставляется ноль.</p>

<p>Адресное поле.  (рис.  2) Оно может содержать от двух до десяти
радиолюбительских позывных.  Простейший случай - два позывных, если два
корреспондента работают между собой непосредственно.  Если эти
корреспонденты находятся вне зоны радиовидимости, то они могут использовать
станции других операторов в качестве ретранслятора.  В одной линии их может
быть до восьми.  Позывные ретрансляторов также включаются в адресное поле.
Таким образом, оно делится на три подполя:  получателя, отправителя и
ретранслятора.  Позывные, занесенные в него, могут состоять не более чем из
шести символов.  Если позывной состоит менее чем из шести символов, он
дополняется соответствующим количеством пробелов.</p>

<center><img src="../GFX/ax25_pics/ax25_3.gif" alt="Основные блоки станции" border=0></center>

<p>После позывного в каждом подполе идет вторичный идентификатор станций.
Это некоторое число от 0 до 15.  Оно обозначает, что оператор имеет
несколько станций пакетной связи, аппаратуру BBS, а также NET/ROM.  Обычно
сам оператор работает с позывным без номера или с номером один, к позывному
"почтового ящика" и узловой станции дополнительно прибавляются цифры от 2
до 9, а при прохождении сигнала транзитом через NET/ROM от 10 до 15, в
зависимости от того, через сколько узловых станций прошел пакет.</p>

<p>Число идентификатора в двоичном виде занимает четыре бита - со второго
по пятый в байте, следующем после каждого позывного.  На рис.  2 эти биты
обозначены как SSID (SECONDARY STATION IDENTIFIER).  Первый бит этого байта
используется как признак конца адресного поля.  Если он обозначен единицей,
то это признак последнего байта адресного поля.  Для шестого и седьмого
битов нет определенного назначения, и они могут использоваться в локальных
сетях по договоренности пользователей.  Восьмой бит в подполе отправителя и
получателя устанавливается в ноль.  В подполе ретранслятора его обозначают
единицей, если пакет прошел через ретранслятор, и ноль, если нет.</p>

<center><img src="../GFX/ax25_pics/ax25_4.gif" alt="Вид передаваемого байта" border=0><br><br>
<img src="../GFX/ax25_pics/ax25_5.gif" alt="Процесс кодирования сигнала" border=0></center>

<p>Установление бита ретранслятора необходимо для того, чтобы
ретрансляторы, находящиеся в зоне радиовидимости друг друга, следовали
очередности передачи пакетов через себя и выполняли эту процедуру строго в
порядке, указанном отправителем пакета.</p>

<p>Управляющее поле.  В нем содержится информация о типе кадра, которая
используется для определения назначения сообщения.  Все кадры пакета можно
разделить на три основных типа:  I - информационные кадры, содержащие
символьную либо цифровую информацию; S - служебные, подтверждающие, что
кадр принят, или содержащие запрос на выдачу очередного информационного
кадра; U - ненумерованные кадры - запрос на соединение-разъединение.  К
этому типу относят и сигналы маяков.</p>

<p>Кроме того, в этом поле записан номер отправляемого кадра или, при
подтверждении о получении сообщения, номер следующего кадра, который готов
принимать TNC корреспондента.  Подобная нумерация введена потому, что через
канал может подряд передаваться несколько кадров - от одного до семи, и она
может помочь разобраться при сбоях.  Если произойдет ошибка в каком-либо из
кадров, то контроллер получателя сообщит контроллеру отправителя о том, что
он готов к приему того номера кадра, который еще не принят или был принят с
ошибкой.  Например, если одна станция отправила другой подряд четыре пакета
и при приеме третьего пакета произошла ошибка, то контроллер получателя в
переводе с машинного на человеческий язык сообщит отправителю:  "готов к
приему третьего пакета".</p>

<p>Информационное поле.  На нем размещается полезная информация объемом до
256 байт, представленная в кодах и которая при приеме корреспондентами
отображается на экране дисплея ЭВМ любительских станций.</p>

<p>Иногда первый бит информационного поля выступает в качестве
самостоятельного подполя - идентификатора протокола.  Это происходит в
случае использования третьего, сетевого уровня при прохождении пакета через
NET/ROM.</p>

<p>Контрольное поле служит для проверки правильности радиообмена.  Оно
представляет собой шестнадцатиразрядное число, которое подсчитывается с
помощью полинома ХI6+ +XI5+X2+1 в соответствии с алгоритмом, приведенным в
рекомендациях ISO 3309 (HDLC) - International Orqa-nization
Standartization, Hiqht - Level Data Link Control Procedures.</p>

<p>TNC отправителя просчитывает контрольную сумму no всему кадру и помещает
ее в конец кадра.  На приемном конце по тому же алгоритму она
просчитывается вновь и сверяется с суммой, помещенной в конце кадра.  Если
эти два числа совпадают, то кадр считается принятым верно.</p>

<p>Существует несколько способов подсчета контрольной суммы:  аппаратный и
программный.  При аппаратном способе кадр проходит через некоторое
устройство (сумматор), и в результате в его регистре оказывается записанным
некоторое число, которое и является контрольной суммой.  Второй способ -
подсчет с помощью специальной программы.  При этом кадр сначала полностью
принимается в оперативную память, а затем производится подсчет.  Первый
способ реализует высокое быстродействие, но требует дополнительных
аппаратных средств.  Второй способ обладает более низким быстродействием,
но дополнительных аппаратных затрат не требует.</p>

<p>Напомним, как должна выглядеть структура станции пакетной связи, чтобы
реализовать протокол АХ.25.  Из схемы (рис.  3) видно, что в состав станции
входят компьютер, TNC, приемопередатчик и антенно-фидерное устройство.</p>

<p>Компьютер может быть использован практически любой.</p>

<p>При проведении экспериментов по пакетной связи во время
советско-канадского лыжного перехода были опробованы ПЭВМ:  "Роботрон
1715", "Радио-86РК" и БК-0010.  За рубежом наиболее популярными
компьютерами, используемыми в системе пакетной связи, являются IBM PC,
COMMODORE 64, TANDY, APPLE, для которых разработано мощное программное
обеспечение, открывающее широкие возможности в использовании пакетной
связи.</p>

<p>Одним непременным условием при выборе компьютера для пакетной связи
является наличие в нем последовательного канала обмена, работающего по
стандарту стыка С2 (RS232).  Как известно, в "Радио-86РК" такой канал
отсутствует, поэтому RA3AU разработал специальную программу "Терминал",
имитирующую этот канал.</p>

<p>При работе на станции пакетной связи оператор набирает информацию на
клавиатуре, а получает ответы в виде символов на экране монитора.
Информация, передаваемая оператором, может быть либо командой для TNC, либо
текстом, предназначенным для корреспондента.</p>

<p>После нажатия на клавишу компьютер определяет код, соответствующий этой
клавише, и посылает его по последовательному каналу.  Обмен по этому каналу
происходит побайтно.  Вид передаваемого байта приведен на рис.  4.
Некоторые параметры, которые характеризуют передаваемый байт, могут быть
различными, но необходимо, чтобы параметры, установленные в TNC и в
компьютере, совпадали.  Их характеризуют следующие параметры; длина
информационного слова (7 или 8 бит), наличие проверки на четность или
нечетность, стартовый бит (один), столовый бит (один, полтора или два),
скорость обмена (50, 75, 150, 300, 1200, 2400, 4800 или 9600 бит/с).</p>

<p>Уровни напряжений, используемых в данном интерфейсе:  единица - от+3 до
+12 В, ноль - от -3 до -12 В.  Информация в направлении от компьютера
передается по линии TXD, а в обратном направлении по линии RXD, кроме того,
существуют еще две дополнительные линии CTS и RTS, по которым подается
сигнал о готовности компьютера или TNC к приему очередного байта.  Прежде
чем передать байт по линии TXD, компьютер проверяет линию CTS.  Если на ней
уровень сигнала характеризует готовность TNC к приему байта, то компьютер
посылает его, если нет, ожидает изменения уровня.  Аналогичную процедуру
производит TNC с использованием линии RXD для передачи информационного
байта и линии RTS для проверки готовности.</p>

<p>Последовательность нескольких байт, поступивших в TNC, может быть либо
командой, либо информацией, предназначенной для отправления по радиоканалу.
В первом случае команда декодируется и исполняется, во втором - формируется
кадр в соответствии с протоколом АХ.25 и переводится из стандартного кода в
код NRZ-1 (поп return to zeroinverted).  В этом стандарте предусмотрено,
что перепад физического уровня сигнала происходит в том случае, если в
последовательности передаваемых бит встречается 0.  Временная диаграмма,
поясняющая этот процесс, приведена на рис.  5, где показана исходная
посылка - и она же в виде кода NRZ-1.</p>

<p>Обычно модем конструктивно выполняется в одном корпусе с TNC.  Его
цифровую часть, как правило, называют ассемблером-дизассемблером кадров.
Ассемблер-дизассемблер кадров и модем связаны между собой четырьмя линиями:
TXD-для передачи кадров в коде NRZ-1, RXD- приема кадров в коде NRZ-1, РТТ
- для включения модулятора и DCD, по которой подается сигнал с демодулятора
о занятости канала.</p>

<p>Модем представляет собой совокупность двух устройств:  модулятора и
демодулятора.  Перед отправлением пакета ассемблер-дизассемблер кадров
включает модем с помощью сигнала на линии РТТ и по линии TXD посылает кадр
в коде NRZ-1.  Модулятор производит заполнение полученной
последовательности двумя звуковыми частотами.  Единица соответствует
частоте F1, а нуль - частоте F2.  Сигнал, промодулированный звуковой
частотой, по линии MlС поступает на микрофонный вход передатчика.</p>

<p>При приеме кадров последовательность импульсов, заполненных звуковой
частотой, с выхода приемопередатчика по линии EAR поступает на вход
демодулятора.  Демодулятор производит обратный процесс:  из
последовательности импульсов звуковой частоты выделяет огибающую, которая и
представляет собой кадр в виде кода NRZ-1.  Этот кадр поступает в
ассемблер-дизассемблер пакетов.  Одновременно с появлением в канале
сигнала, промодулированного одной из частот F1 или F2, срабатывает
специальный детектор, вырабатывающий на выходе сигнал, свидетельствующий о
занятости канала.</p>

<p>Сигнал РТТ, кроме включения модулятора, выполняет еще одну функцию -
управляет транзисторным ключом, который переключает приемопередатчик с
приема на передачу.</p>

<p>В радиолюбительской пакетной связи используются два типа модемов:  для
коротких и ультракоротких волн.  На KB используется однополосная модуляция,
а скорость передачи по радиоканалу 300 бит/с, при этом разнос звуковых
частот, соответствующих нулю и единице, должен составлять 200 Гц.  Частота
модуляции может быть различной.  Однако удобства отсчета рабочей частоты
радиостанции в Европе приняли стандарт, по которому установлено, что нулю
соответствует 1850 Гц, а единице-1650 Гц.</p>

<p>На ультракоротких волнах работают на скорости передачи 1200 бит/с при
разносе частот 1000 Гц.  Так как на УКВ используется, как правило,
частотная модуляция, то частоты должны быть строго фиксированы.  Принято,
что нулю соответствуют 1200, а единице - 2200 Гц.</p>

<p>В заключение хочется отметить правовую сторону вопроса.  В инструкцию по
эксплуатации любительских радиостанций, разработанной ещё ФРС СССР,
включена, как равноправная, любительская пакетная связь.</p>

<p>Более детально о принципах пакетного радио можно прочитать <a href="http://ur7iwz.qrz.ru/pr/packetradio.php"><font color="green">здесь</font></a>.</p><BR>
</font></td></tr>
</table>

<script language="JavaScript" src="../downalt.js"></script>
</BODY>
</HTML>
