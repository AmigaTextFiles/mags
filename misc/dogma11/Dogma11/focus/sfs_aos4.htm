<html>
<!-- created on Pegasos I/600Mhz ATI Radeon 9200SE 128Mb 40GB Nec Combo -->
<head>
<meta http-equiv="content-type" content="text/html; charset=windows-1251">
<meta http-equiv="content-language" content="ru">
<meta name="robots" content="index,follow">
<meta name="keywords" content="amiga, poweramiga, амига, dogma, догма, magazine, e-zine, журнал, электронный журнал, amif1team, akuji, vinnny, russia, ukraine, amigaone, pegasos, amigaos, morphos, motorola, powerpc, g3, g4, a1200, a4000, cd32, workbench, opus, back to the future, back for the future">
<meta name="description" content="Догма - русскоязычное переодическое интернет издание посвящённое компьютерной платформе Amiga/Pegasos. Until the End of Time!">
<meta name="author" content="amif1team/team Dogma">
<meta name="copyright" content="Copyright © 2002-2008 team Dogma">
<link rel="icon" href="../gfx/icon.png" type="image/png">
<link rel="shortcut icon" href="../gfx/favicon.ico">
<title>Догма - электронное Амижное издание</title>
</head>
<body bgcolor="black" link="yellow">

<script language = "JavaScript">
function newImage(ImageIndex, NewButton)
{
NewButton = "../gfx/" + NewButton+".png"
document.images[ImageIndex].src = NewButton
return;
}
</script>

<table align="center" width="800" border="0" cellspacing="0" cellpadding="0" bgcolor="#eeeeee">

<tr height="125">
<td width="800"><a href="http://www.dogma.org.ru/"><img src="../gfx/up.png" width="800" height="125" border="0" alt="Догма - электронное Амижное издание"></a></td>
</tr>

<table align="center" width="800" border="0" cellspacing="0" cellpadding="0" bgcolor="white">

<tr height="25">

<td width="89"><a href="../about/index.html" onmouseover="newImage(1, '1a')" onmouseout="newImage(1, '1')"><img src="../gfx/1.png" alt="Колонка редакции" width="89" height="25" border="0"></a></td>

<td width="65"><a href="../interview/index.html" onmouseover="newImage(2, '2a')" onmouseout="newImage(2, '2')"><img src="../gfx/2.png" alt="Наши гости" width="65" height="25" border="0" valign="top"></a></td>

<td width="82"><a href="../history/index.html" onmouseover="newImage(3, '3a')" onmouseout="newImage(3, '3')"><img src="../gfx/3.png" alt="Хроника событий" width="82" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

<td width="86"><a href="../focus/index.html" onmouseover="newImage(4, '4a')" onmouseout="newImage(4, '4')"><img src="../gfx/4.png" alt="В фокусе" width="86" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

<td width="159"><img src="../gfx/5.png" alt="" width="159" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

<td width="86"><a href="../exclusive/index.html" onmouseover="newImage(6, '6a')" onmouseout="newImage(6, '6')"><img src="../gfx/6.png" alt="Xклюзив" width="86" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

<td width="80"><a href="../utilities/index.html" onmouseover="newImage(7, '7a')" onmouseout="newImage(7, '7')"><img src="../gfx/7.png" alt="Программы и утилиты" width="80" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

<td width="87"><a href="../games/index.html" onmouseover="newImage(8, '8a')" onmouseout="newImage(8, '8')"><img src="../gfx/8.png" alt="Игротека" width="87" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

<td width="66"><a href="../download/index.html" onmouseover="newImage(9, '9a')" onmouseout="newImage(9, '9')"><img src="../gfx/9.png" alt="Download" width="66" height="25" hspace="0" vspace="0" border="0" align="top"></a></td>

</tr>
</table>

<table align="center" width="800" border="0" cellspacing="0" cellpadding="0" bgcolor="black">
<tr>
<td bgcolor="black" width="800" valign="top">



<table align="right" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="black">
<tr>
<td bgcolor="#ffffff" valign="top">

<table width="100%" border="0" cellspacing="0" cellpadding="8" bgcolor="black">
<tr bgcolor="black" background="../gfx/back.png">
<td colspan="3"><font color="white" size="2">

<p align="center"><font size="+1" color="yellow"><b>Инсталляция и использование файловой системы SFS под AmigaOS 4</b></font></p>

Вашему вниманию предоставляется подробная инструкция по установке и использованию файловой системы SFS под операционной системой AmigaOS 4. Эта тема поднималась уже давно и вот ответы на все ваши вопросы.<br><br>
Что ж, для начала нам необходимо отредактировать и подготовить Kicklayout. Делается это с помощью представленной утилиты Media ToolBox в несколько этапов. Приступим.<br><br>
1. SLB (второй загрузочный уровень)<br>
2. Kicklayout<br>
3. MTB<br>
4. Shell Orders (командная строка)<br><br>
<font color="yellow" size="+1"><b>1. SLB</b></font><br><br>
SLB (Second Booter Level) своего рода это основа AmigaOne. Благодаря ему винчестер начинает загрузку операционной системы под руководством UBoot. В использовании SFS может быть два направления:<br><br>
1.1 Первое, если вы хотите использовать ваш диск целиком и полностью под SFS (все разделы, включая загрузный), тогда нам понадобится SLB V2.<br><br>
1.2 И второе, если вы хотите смешивать, то есть использовать разные разделы с использованием разных операционных систем (например: Linux/MOL и AmigaOS 4), то это предполагает использование разных файловых систем: последняя под FFS, тогда следует использовать SLB поддержку для всех режимов (предложения вам на CD  тестовая (slb_v2 1.8b), более понятная в использовании, но не как более функциональная).<br><br>
<font color="yellow">Дополнительная информация</font><br><br>

1.b Это решение SLB не поддерживает старт разных операционных систем (например, Linux и AmigaOS 4), находящихся на разных разделах на разных дисков, более подробнее об этом можете прочитать на портале <a href="http://www.amigaworld.net/">amigaworld.net</a>.  
<br><br>
<font color="yellow" size="+1"><b>2. Kicklayout</b></font><br><br>
<font color="yellow">Внимание:</font> не размещайте SFS в RDB раздел вашего диска!<br><br>

Kicklayout - это файл конфигурации, содержащийся на вашем диске и непосредственно влияющий на загрузочное ядро AmigaOS 4, где собственно и находятся утилиты, активизирующие подобные файлы как SmartFileSystem. Вот что стоит проделать:<br><br>

2.1 Откройте файл Kicklayout в любом из удобных вам текстовых редакторов и впишите между строками секции "nodebug" и "debug" (если оно конечно уже не вписано до вас) следующую строку:<br><br>
<font color="yellow">MODULATE Kickstart/SmartFileSystem</font><br><br>

2.2 Естественно обязательно убедитесь, что сам файл SmartFileSystem находится в каталоге SYS:Kickstart repertory/.<br><br>

2.3 Заметьте, что файла SmartFileSystem не должно быть в директории L: как это было в старых версиях AmigaOS, если он там присутствует, то его стоит немедленно удалить.<br><br>
2.4 Проверьте наличие diskcache.library.kmod в каталоге SYS:Kickstart/ repertory и естественно наличие в файле Kicklayout строки "MODULATES Kickstart/diskcache.library.kmod" - надеюсь это комментировать не стоит.<br><br>

<font color="yellow">Дополнительная информация</font><br><br>

SFS теперь внесён в Kicklayout, это мы видим при каждом старте CD с AmigaOS 4. Помните, что пометка DiskCache при этом желательна, но не столь категорична.
<br><br>
<font color="yellow" size="+1"><b>ToolBox Media</b></font><br><br>

Media Toolbox - это не что иное, как старый добрый "HDToolbox" просто в новой интерпретации и в новой AmigaOS.
<br><br>
3.1 Перво-наперво стоит зайти в типы утилит с помощью соответствующей иконки MTB, характеризующей особенности настройки соответствующего интересующего нас устройства. Для примера "sii0680ide.device" являет собой драйвер устройств, висящих на шине NCV SiL ATA. Тут стоит отметить один недостаток MTB – он будет показывает список всех устройств, которые до этого были подключены, и с которых осуществлялся запуск непосредственно системы. Возможно со временем это будет исправлено, а то порой от накопившегося аж волосы дыбом становятся. :)<br><br>
3.2 После выбора необходимого нам драйвера простейшее меню MTB покажет вам все подключенные устройства где вы и выберете интересующий вас диск. Выбираем диск, на который хотим инсталлировать SFS, и нажимаем кнопку "RDB/Reinstall Edict", заходим в раздел "AmigaOne Boot Codes". Тут выбираем "Install AmigaOne Booter" и осуществляем выбор файла SLB, в данном случае SYS:L (L:), который поддерживает SFS. Подтверждаем проведённые изменения и выходим в начальное меню MTB.<br><br>

3.3 В разделе "Edict Partitions and FileSystems", сильно отличающимся от классической AmigaOS, не производим никаких действий. SFS не должна входить в RDB раздел, она находится как бы поверх него. Всё это я уже рассказывал немного выше при изменении Kickstart, тут просто напоминаю.<br><br>

3.3a Устанавливаем размер нашего раздела и помним, что это первый (стартовый раздел), с которой и будет осуществляться загрузка операционной системы. Не забудьте поставить соответствующую пометку на диске. Все эти установки следует проделать, если вы ходите сделать более одного SFS-раздела:<br><br>
3.3b Присваиваем имя нашему разделу, обратите внимание, чтобы оно не совпадало с ранее заданными именами, ставим галочку "automount" на всех созданных разделах и соответственно ставим галочку в разделе "bootable", находящимся в том разделе, на котором находится AmigaOS 4.<br><br>

3.3c Выбираем раздел, который собираемся использовать и нажимаем на кнопку "select filesystem/edit details" где выбираем "Custom FileSystem". Теперь внимательно вписываем идентификатор SFS "53465300", затем немного подождём. В конце данного процесса вы увидите надпись "SFS/00", что свидетельствует о правильности заполнения поля идентификации.<br><br>

3.3d Параметр "Blocksize" должен всегда быть установлен на отметке 512 для нормальной работы SFS.<br><br>

3.3e Параметр "Maxtransfer" должен равняться 1FE00 для A1200 PowerPC и A4000 PowerPC под AmigaOS 4, и 0x7FFFFFFF для AmigaOne/Sii0680/Sii3112.<br><br>

3.3f Параметр "Mask" должен быть установлен 0xFFFFFFFE для A1200 PowerPC и A4000 PowerPC под AmigaOS 4, и 0xFFFFFFFE для AmigaOne/Sii0680/Sii3112.<br><br>

Не забудьте проделать это со всеми имеющимися у вас дисками и обязательно подтвердите все внесённые изменения.<br><br>
 
3.4 Форматируем диск. Очень важно: для форматирования разделов в Workbench, использовать исключительно опцию "Quick Format".<br><br>

3.4b Если вы всё сделали правильно, то у вас не должно возникнуть проблем. Если есть побочные эффекты (например, не создаётся "recycled", что-то сильно тормозит и так далее) используйте утилиту SFSFormat, находящуюся в SFS-архиве на <a href="http://www.aminet.net/">Aminet</a>.<br><br>

<font color="yellow">Известные недостатки</font><br><br>

При запуске MTB и выборе в начальном окне вашего диска, на который вы уже поставили  SFS, система сигнализирует об ошибке - "can't find the SFS filesystem in ROMANIAN" (не нашёл раздел SFS в контексте  ROMANIAN). Всё нормально, это глюк, просто нажмите опцию "select any" для продолжения. Данный глюк разработчики обещают исправить в следующей версии, как и недочёт со списком устройств. <br><br>
<font color="yellow" size="+1"><b>Shell Orders (командная строка)</b></font>
<br><br>
Это секция содержит записанную информацию о том, что раздел использует SFS.<br><br>

4.1 Утилита SFSQuery (версии 1.1 теперь используется в AmigaOS 4, уже не требует наличие ixemul-библиотеки, и доступна на сайте <a href="http://strohmayer.org/sfs/">strohmayer.org/sfs/</a>). Что ж, запоминаем:<br><br>
<font color="yellow">10.OS4: > sfsquery tonyboot: SFSquery <br>
information for tonyboot: (SFS Version 1.235) Start/end-Offset: <br>
0x00000000:00102000 - 0x00000000:3baf6000 API Device: <br>
(standard) Bytes/block: 512 Total blocks: 1953696 <br>
Mask accesses: 1932316 Mask put: 3973 (0%) Read-ahead <br>
hides: 8x 8192 bytes (Copyback) Flush timeout: act. <br>
20s - inact. 0.5s Max Name Length: 107 DOS buffers: <br>
1000 SFS settings: [ RECYCLED ] 10.OS4: > <br>
version sfsquery SFSquery 1.1</font><br><br>

Утилита очень удобная и применяется для создания буфера памяти на вашем диске, тут линия "mask put" оценивается в процентном отношении, где можно наглядно контролировать значение маски. Для примера, если значение 0% (очень хорошо) тогда система использует около 1000 буферов памяти. Сам регулятор буферов памяти устанавливается при помощи небезызвестной утилиты MTB для каждого раздела в отдельности. Здесь желательно выделить столько памяти столько требуется, не стоит злоупотреблять этим параметром.<br><br>
 
4.2 Восстановление/возобновление удалённой информации.<br><br>
Если вам потребовалось восстановить ранее удалённую информацию, SFS предоставляет вам такую возможность. Лимит таких восстановлений - последние 360 удалённых файла (естественно, если они сохранились при том, что сами файлы не занимают много места, да и сам диск достаточно ёмкий).<br><br>

Для восстановления таких данных вам необходимо открыть Shell и указав имя раздела выбрать необходимый файл. Пишем имя раздела, затем "recycled" и попадаем в необходимый нам список удалённых файлов (тут я вам рекомендую использовать  Directory Opus или что-то подобное для облегчения процесса).<br><br>

Для примера, я случайно стёр адресную книгу почтовика Yam (О-нет!) что же мне делать.<br><br>
<font color="yellow">11.Ram: > os4: 11.OS4: > recycled <br>
11.OS4:.recycled > to dir addressbook 11.OS4:.recycled ></font><br><br>

Для восстановления этого файла просто копируем его туда откуда стёрли, и всё!<br><br>
<font color="yellow">11.OS4:.recycled>copy addressbook yam: <br>
11.OS4:.recycled ><br><br>

Важная информация</font><br><br>

Помните, что всякий удалённый вами файл попадает в каталог "recycled". Но файлы в каталоге "recycled" также занимают место, просто они не учитываются при запросе свободного места на диске, раздел "information".<br><br>

Пример: Я удалил достаточно много больших файлов, а затем записал много новых. Что мы получили: часть "recycled" файлов исчезла, так как из-за недостаточности места они просто затёрлись новыми, помещенными по сути на их же место.<br><br>

Поэтому, иногда полезным будет самому пересмотреть каталог "recycled" (во избежание окончательной потери случайно стёртой информации).<br><br>

Если же вы просто хотите застраховаться от этого, например, для сохранения всей важной информации, просто сделайте "NoRecycled" в утилите SFSFormat.<br><br>

И напоследок помните, что при полном форматировании SFS-раздела, вся информация, которая находилась до этого момент на вашем диске, будет безвозвратно утеряна! Правильно используйте SFS и тогда вы на 100% будете застрахованы от всякого рода потерь информации на вашем диске.<br><br>
 
<font color="yellow">Дополнительная информация</font><br><br>

Если вы используете утилиту SFSFormat для форматирования диска, то поставьте метку напротив пункта "ShowRecycled" (тогда ваш список удалённых файлов будет всегда под рукой) и пользуйтесь файловыми менеджерами, например, Directory Opus значительно облегчит вам работу.<br><br>

Послесловие: большое спасибо Jorg Strohmayer и Ventzislav Tzvetkov за проверку, коррекцию и тест.<br><br>
<div align="right"><font color="yellow" size="1"><b>Перевод</b> <i>-= / amif1team / =-</i> © 12/2007<br><b>Автор</b> <i>-= / Tony Aksnes / =-</i> © 02/2005</font></div>

</td>
</tr>
</table>

</table>
<script language="JavaScript" src="../page.js"></script>
</body>
</html>