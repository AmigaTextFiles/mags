<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD><TITLE>Power Flyer - Enhanced IDE Amigaan</TITLE></HEAD>
<BODY>

 <HR>
 <B>Power Flyer - Enhanced IDE Amigaan</B><BR>
 <I>Jarmo Piippo</I>
 <HR>

 <P>
Tietokoneet ovat aina pullollaan pullonkauloja, ja yksi kuuluisimmista on
Amiga 1200:n emolevyn hidas IDE-liitäntä. Hampaiden kiristelyn ja itkun
tuhertamisen voi kuitenkin onneksi lopettaa, sillä kiertoteitä ongelmaan on
tarjolla.
 </P>

 <P>
Vanhan polven amigistien mielissä kiintolevyliitäntöjen ylivoimainen
ykkönen on tietysti nopee ja upee SCSI. Mutta IDE- ja SCSI-levyjen
hintaerojen kasvettua vähitellen tyrmäävän suuriin mittoihin on valtaosa
populaatiosta joutunut nielemään ylpeytensä ja siirtymään IDEalistiksi.
Power Flyer on yksi keino ottaa IDE-pyörittimensä siirtonopeudesta
mahdollisimman paljon irti, eikä lysti edes maksa juurikaan enempää kuin
vastaavan tehoinen SCSI-ohjain.
 </P>

 <P><H3>Vauhdin hurmaa ja perusturvaa</H3></P>

 <P>
Power Flyer korvaa koneesi vakio-IDE:n kahdella nopealla EIDE-portilla,
joista kumpaankin voi liittää kaksi laitetta. Molemmat liitännät on sekä
puskuroitu että terminoitu, joten edes neljän laitteen käytöllä ei tarvitse
pelätä ylikuormittavansa koneen dataväyliä. Flyer tunnistaa automaattisesti
siihen liitettyjen laitteiden tukemat siirtomoodit ja vaihtaa nopeimmat
mahdolliset käyttöön. Siirtomoodeja (PIO eli Programmed Input/Output) on
käytettävissä kolme, PIO0, PIO3 ja PIO4. A1200:n oma IDE-liitin pystyy
käyttämään levyjä vain hitaimmassa PIO0-tilassa. Flyerin ajuriohjelma
tunnistaa myös käytössä olevan prosessorin ja valitsee sille optimoidut
siirtorutiinit.
 </P>

 <P>
Flyer liitetään A1200:aan Kickstart-ROM-piirien kannoille, joten sillä on
suora pääsy koneen dataväylälle täydellä leveydellä. Laite onkin emolevyn
liitäntänsä osalta täysin 32-bittinen, mikä selittää suuren siirtonopeuden.
Flyer on konfiguroitu samalle Chip-muistialueelle kuin emolevyn IDE-portti.
Ratkaisu mahdollistaa sen hienon ominaisuuden, että ohjaimen ykkösportissa
olevat asemat näkyvät koneelle jo ennen ajuriohjelman käynnistämistä, aivan
kuin ne olisivat emolevyn omassa liittimessä. Niinpä koneen
kylmäkäynnistykseen ei tarvita käynnistyslevykettä, kuten esimerkiksi Surf
Squirrelin tapauksessa. Tosin haittapuolena on, ettei Flyerin asentamisen
jälkeen emolevyn IDE-liittimessä saa olla enää mitään laitetta kytkettynä.
 </P>

 <P ALIGN=CENTER>
 <IMG SRC="kuvat/powerflyer.jpg" WIDTH=368 HEIGHT=256 ALT="Power Flyer"><BR>
 Kuva: Power Flyer kurkistaa tornin johtoviidakon keskeltä.
 </P>

 <P>
Yksi Flyerin tuomista mukavuuksista on se, että ATAPI-CD-ROM-asemat
toimivat nyt A1200:n oman scsi.devicen avulla eivätkä tarvitse mitään
ulkoisia laiteajureita (kuten IDEfix tai atapi.device).
CD-ROM-tiedostojärjestelmäksi kelpaa mainiosti AmiCDFS 2.40 tai sen
vanhempi ilmainen versio AmiCDROM 1.15, jotka molemmat löytyvät Aminetistä.
Power Flyeria tukee myös uusi ja monipuolinen kaupallinen
CD-tiedostojärjestelmä AllegroCDFS. Siinä on ensimmäisenä Amigalla tuki
UDF:lle, joka on video-DVD-levyjen formaatti. Itselläni ei ole vielä
AllegroCDFS:ää, eikä sen puoleen DVD-asemaakaan, mutta DVD-tuki saa kyllä
tulevaisuuden näyttämään paljon valoisammalta.
 </P>

 <P>
Flyerin omistaja voi kauppareissulla käydessään huoletta ostaa vaikkapa
kymmenen gigatavun kiintolevyn. Laite nimittäin jakaa neljän gigatavun
rajan ylittävät levyt automaattisesti näkymään koneelle useina korkeintaan
tasan neljän gigan kokoisina levyinä. Niinpä uudella jättilevyllä voi
turvallisin mielin jatkaa vaikka vanhan tutun FFS:n käyttöä. Haittapuolena
on, ettei ilmeisesti tuon rajan ylittävän kokoista yksittäistä tiedostoa
voi luoda. Sellaiselle kun saattaisi tulla tarvetta esimerkiksi
kirjoittavien DVD-RAM-asemien yleistyessä, jos joutuu käyttämään levyn
poltossa image-tiedostoa. Tällä hetkellä DVD-RAM-levylle mahtuu 2,6 Gt
molemmille puolille, eli yhteensä yli viisi gigatavua. Tänä syksynä
myyntiin tulevissa DVD-RW-asemissa tallennuskapasiteetti on jo kolme
gigatavua levypuolta kohti. Osion maksimikokoa en ole itse pystynyt
testaamaan, sillä en vielä edes omista siihen riittävän suurta kiintolevyä,
joten en voi sanoa mitään varmaa asiasta.
 </P>

 <P><H3>Nyt tiukkana, sanoi Flyer!</H3></P>

 <P>
Asennus on melko hankala toimenpide piirikantojen ylettömän tiukkuuden
takia. Kantoihin tulevat Flyerin piikit ovat pyöreitä, eivätkä litteitä
kuten ROM-piirien jalat, joten laitteen saaminen paikoilleen vaatii enemmän
voimaa kuin piirien. Tilannetta vielä pahentaa se, että Flyerin tapauksessa
joutuu painamaan kaikki pinnit kiinni molempiin kantoihin yhtä aikaa.
Emolevy onkin siinä tilanteessa melkoisella rasituksella, joten kannattaa
ehkä ottaa sen alapuolinenkin suojapelti kokonaan pois ja laittaa emolevy
tasaiselle alustalle, jottei se taivu murtumispisteeseen asti. Kun kortti
on paikallaan, laitetaan ROM-piirit Flyerin ROM-kantoihin, jotka ovat
samalla kohdalla kuin alkuperäiset. Kokonaisuus vielä kiinnitetään
nippusiteillä ROM-piirien kantojen alta. Sen jälkeen on kyllä hankala enää
vaihdella ROMeja uudempiin, joten mahdollinen KS3.1-päivitys kannattaa
tehdä samalla kun hankkii Power Flyerin.
 </P>

 <P>
Kortin asettelussa ROM-kannoille on oltava tarkkana, sillä niissä on yksi
aukkopari enemmän kuin itse piireissä tai Flyerissa on jalkoja.
Ylimääräiset aukot on varattu suurempien ROM-piirien asennusta varten,
sillä A1200:aan voi asentaa yhden megatavun verran ROM-muistia. Tosin
suurempien piirien asennus ei onnistu enää Flyerin hankinnan jälkeen, sillä
Flyerin kannat ovat vain nykyisille piireille sopivaa kokoa. Laitteen
asennus on selostettu manuaalissa hyvin tarkasti ja runsaiden valokuvien
kera. Kuvat ovat tosin melko pieniä ja hiukan liian tummia.
 </P>

 <P>
Flyerin piirilevyyn nauhakaapelilla yhdistetyllä pienellä erillisellä
kortilla on piirikanta, joka täytyy painaa nurinpäin A1200:n Gayle-piirin
päälle. Sekin on melko tiukka laittaa, mutta ei onneksi niin tiukka kuin
ROM-kannat. Lisäksi sen perillemenonkin huomaa paremmin, sillä kanta
napsahtaa kuuluvasti mennessään paikoilleen. Sen irtisaaminen voikin olla
sitten jo toinen juttu, ainakin jos haluaa ettei Gayle irtoa juotoksistaan
piirilevyltä kannan mukana... Lopuksi vielä yhdistetään Flyerista yksi
erillinen kytkentälanka emolevyn IDE-liittimen piikkiin 39, jotta A1200:n
kiintolevy-LED palaa nätisti levytoimintojen aikana kuten aina ennenkin.
 </P>

 <P>
Ohjelmiston asennus tapahtuu normaaliin tapaan installer-ohjelman avulla.
Asennuksessa Startup-Sequenceen tulee muutama rivi lisää. Lisäys käynnistää
bootissa Flyerin ajuriohjelman ATA3.driver, joka ottaa myös ohjaimen
kakkosportin käyttöön ja vaihtaa kaikki liitetyt asemat käyttämään nopeinta
mahdollista siirtomoodia. Ajuri jää muistiin ja on resetin kestävä, joten
seuraavassa resetissä myös kakkosportin asemat näkyvät käynnistysvalikossa.
 </P>

 <P><H3>"Olisinpa tiennyt tämän!"</H3></P>

 <P>
Ennen Power Flyerin ostopäätöstä on ehdottoman tärkeää tarkistaa koneensa
kelloportin piikkien sijoitus. Siinä on nimittäin ollut eroja
valmistussarjojen välillä, ainakin Flyerin manuaalin mukaan. Koneen edestä
katsottuna kelloportin piikkien on oltava liitinalueen oikeassa
puoliskossa, ja sen vasemmassa puoliskossa emolevyllä tulee näkyä pelkät
käyttämättömät paikat toiselle satsille piikkejä. Jos piikit ovat
vasemmassa päädyssä tai niitä on koko alueen matkalla, ei Flyerin asennus
onnistu, sillä sen piirilevy yltää kelloportin vasemman päädyn kohdalle
asti (ja Chip-RAM-piirien päälle).
 </P>

 <P>
Toinen huomioitava asia on, että piirilevy yltää
näppäimistökontrolleripiirin reunalle asti, joten ennen laitteen ostoa
kannattaa kysyä, mahtuuko se koneeseen yhtä aikaa esimerkiksi
BlizzardVision-näytönohjaimen kanssa, jos suunnittelee sellaisen hankintaa.
Kelloporttiin liitettävien laitteiden käyttö Flyerin kanssa onnistuu, mutta
vaatii lyhyen jatkokappaleen Flyerin läpi. Jatkokappale ei kuulu laitteen
hintaan, joten se on hankittava erikseen tai tehtävä itse. Kelloportin
jatkeen pituus ei saa ylittää neljää senttimetriä, sillä kyseiseen porttiin
tulee muutamia koneen osoite- ja dataväylän linjoja.
 </P>

 <P>
Kun asennus on sitten lopultakin valmis, huomataan yllättäen, ettei A1200:n
peltisen suojakotelon yläosa ehkä mahdukaan enää kiinni. Noh,
tornikoteloissahan on häiriösuojaukset omasta takaa, mutta pöytäkotelossa
majaileva Amiga kyllä vaatisi suojapellin säilyttämisen ennallaan. Vaikka
emolevyn kellotaajuus ei mikään kunnioitusta herättävän suuri olekaan,
aiheuttaa se silti kohtalaisen voimakkaita radiohäiriöitä ilman suojausta.
 </P>

 <P>
IDE-kaapelin ja laitteiden liittämisessä on varmistettava, että ne tulevat
oikein päin. Flyerin liitin on toisin päin kuin emolevyn vastaava, joten
erehtymisen vaara on olemassa. Erityisen tarkkana on oltava tiheän
44-piikkisen liittimen käytössä, siinä kun on mukana myös käyttöjännitteet,
joten väärin kytkeminen voi olla tuhoisaa. Valmistaja suosittelee ennen
levyjen liittämistä ohjaimeen kokeilemaan sitä tyhjänä, jotta voi
varmistaa, että kone yleensä yhä käynnistyy. Mikäli näkyviin ilmestyy
normaali alkuanimaatio, joka kehottaa laittamaan käynnistyskorpun asemaan,
voi seuraavaksi kokeilla käynnistyskiintolevyn kytkemistä kaapeliin, ja
mikäli sekin toimii, kytkeä loput laitteet. (Kaikki kytkennät tehdään
tietysti virtojen ollessa sammutettuna, mutta senhän toki jokainen jo
tietääkin...)
 </P>

 <P>
Levyn, jolta kone halutaan käynnistää, on oltava ykkösportissa masterina.
Rajoitus koskee vain kylmäkäynnistystä, resetvalikosta voi koneen bootata
miltä tahansa Flyeriin liitetyltä asemalta (mukaanlukien Zip ja LS-120).
Ykkösportille on valittavissa joko 40 tai 44 pinnin liitin (3,5:n tai 2,5:n
tuuman levy). Molempia ei tietenkään saa kytkeä yhtä aikaa. Kakkosportille
on ainoastaan 40-piikkinen liitin. Samaan kaapeliin ei kannata sijoittaa
nopeaa (PIO3 tai PIO4) ja hidasta (PIO0) moodia käyttäviä asemia, koska
silloin kyseinen portti toimii aina hitaammalla nopeudella. Nopeiden
moodien levyjen (PIO3 ja PIO4) välillä tätä rajoitusta ei ole.
 </P>

 <P>
IDE-liitännän reset-linja (kaapelin johtimessa 1) välittyy Flyerin läpi,
joten CD-ROM-asemat kolistelevat lukupäitään jokaisessa resetissä. Turhaan
kolisevat, sillä siitä ei ole mitään hyötyä normaalikäytössä, ja tuskinpa
se kuitenkaan riittää vikatilanteitakaan ratkaisemaan. Haittaakaan siitä
tuskin silti on. Sitä paitsi sama ominaisuus kuuluu myös
perus-IDE-porttiin.
 </P>

 <P><H3>Gentlemen, start your engines!</H3></P>

 <P>
Kylmäkäynnistyksen aikana Flyerin ajuri ei tietenkään ole vielä muistissa,
joten kiintolevy toimii silloin vain emolevyn IDE-liitännän nopeudella.
Startup-Sequencessa ajetaan kuitenkin yleensä niin pieniä tiedostoja, että
kiintolevyn lukunopeudella on käynnistymisaikaan vähemmän merkitystä kuin
levyn hakuajalla.
 </P>

 <P>
"Mutta entäs se nopeus sitten? Kerro nyt jo!" Hyvä on, seuraavassa
taulukossa on Flyerin kautta saavutettu lukunopeus hiukan vanhahtavilla
kahden gigatavun kiintolevyilläni, mitattuna ScsiSpeed 4.2-ohjelmalla,
kahdella eri puskurikoolla (32 kt ja 256 kt).
 </P>

 <TABLE>
  <TR><TD>			<TD>Power Flyer	<TD>A1200 IDE
  <TR><TD>WD Caviar (32kt)	<TD>4 456 448	<TD>2 488 729	<TD>tavua/sek
  <TR><TD>WD Caviar (256kt)	<TD>4 521 984	<TD>2 529 689	<TD>tavua/sek
  <TR><TD>Bigfoot (32kt)	<TD>6 915 686	<TD>2 221 670	<TD>tavua/sek
  <TR><TD>Bigfoot (256kt)	<TD>7 222 067	<TD>2 555 904	<TD>tavua/sek
 </TABLE>

 <P>
Levyillä käytetyn tiedostojärjestelmän nopeudesta tietysti riippuu, kuinka
paljon käytännön nopeus poikkeaa raakanopeuden sanelemasta maksimiarvosta.
Käytännön testinä kokeilin suurten tiedostojen siirtoa kopioimalla IMDb:n
datatiedostoja, joita on noin 210 megatavua. Niiden kopiointi levyltä
toiselle samassa portissa toimi hiukan yli kaksi megatavua sekunnissa.
Kopiointinopeuteen osaltaan vaikutti PFS2-tiedostojärjestelmän käyttö,
mutta nopeutta saa huomattavasti lisää myös FFS:llä nostamalla levyn
blokkikoon vaikkapa kahteen kilotavuun. Kopiointinopeus nousisi tietysti
vielä olennaisesti lisää, jos käytettävissä olisi edes hiukan
nykyaikaisempia kiintolevyjä. :-/
 </P>

 <P>
Vaikka yhteys Flyerilta emolevylle toimiikin nopeasti, lopputulosta
rajoittaa tiedonsiirto Flyerin käyttämän Chip-muistialueen ja varsinaisen
kohteen välillä. Lisäksi kyseinen siirto tapahtuu täysin ohjelmallisesti,
joten se vie runsaasti prosessoritehoa. Tosin niinhän se vie emolevyn omaa
IDE-porttiakin käytettäessä, mutta vain selvästi huonommalla
hyötysuhteella.
 </P>

 <P><H3>Hienosäätöä ilman lekaa</H3></P>

 <P>
Siltä varalta, ettei Flyerin ajuri tunnistaisi jotain liitetyistä asemista
oikein, voi asemien siirtomoodeja vaihtaa myös käsin ATA3Prefs-ohjelmalla.
Käytännössä sitä ei pitäisi tarvita, ellei porttiin kytketä jotain
epästandardia tai ikivanhaa laitetta. Kokeilin kerran erästä lainassa
ollutta 170-megaista yli viisi vuotta vanhaa Conner CP30174E -kiintolevyä,
ja Flyer tunnisti senkin heti oikein, joten tuskinpa asetuksia joutuu
koskaan käyttäjä muuttelemaan. Samalla asetusohjelmalla voi tarvittaessa
myös asettaa ATA3.driverin tilaan, jossa se ei säily koneen muistissa
resetin yli, kuten se normaalisti oletuksena tekee.
 </P>

 <P>
Ajamalla shellissä komentoriviltä Flyerin ajuriohjelma ATA3.driver ikään
kuin normaalina komentona voi varmistaa, että kaikki käytössä olevat
IDE-laitteet on tunnistettu oikein. Ohjelma antaa omassa koneessani
seuraavan näköisen tulosteen:
 </P>

 <TABLE>
  <TR><TD>Primary	<TD>Master	<TD>ATA		<TD>PIO4	<TD>WDC AC22100H		<TD>2111MB
  <TR><TD>Primary	<TD>Slave	<TD>ATA		<TD>PIO4	<TD>QUANTUM BIGFOOT_CY2160A	<TD>2111MB
  <TR><TD>Secondary	<TD>Master	<TD>ATAPI	<TD>PIO3	<TD>CR-2801TE
 </TABLE>

 <P>
Ilmoituksesta näkee kaiken tarpeellisen aina asemien sijoituksia ja niiden
siirtomoodeja myöten, käynnistämättä edes HDToolboxia. Erinomaista! Huomaa,
että jos ATA3.driveria ei ole käynnistetty Startup-Sequencessa, sen
ensimmäinen ajokerta shellissä vain aktivoi ajurin muistiin ja vasta toinen
antaa tällaisen tulosteen.
 </P>

 <P>
Vaihdettavaa mediaa käyttävät asemat kuten CD-ROM toimivat Flyerin kautta
hyvin siinäkin mielessä, ettei levyn vaihtoa tarvitse välttämättä tutkia
pollauksella. Keskeytyspohjainen levynvaihdon tunnistus tulee
automaattisesti käyttöön, jos asema itse (ja käytetty
CD-tiedostojärjestelmä) vain tukee sitä. Sen huomaa siitä, ettei aseman tai
IDE-ohjaimen LED välky kolmen sekunnin välein kuten yleensä, vaan pysyy
pimeänä, vaikkei asemassa olisikaan levyä. Varsinainen haitta
ohjelmallisesta levynvaihdon pollauksesta on se, että se vie useimmilla
ohjaimilla hiukan prosessoritehoa kolmen sekunnin välein, mikä voi
hankaloittaa aikakriittisten ohjelmien virheetöntä toimintaa ja saattaa
jopa aiheuttaa pieniä nykäyksiä animaatioihin. Suurimman osan uudemmista
CD-ROM-asemista luulisi tukevan keskeytyspohjaista levynvaihdon
tunnistusta, ja ainakin oma Mitsumini niin tekee, vaikka onkin jo yli vuoden
vanha malli.
 </P>

 <P><H3>Plussat ja miinukset</H3></P>

 <P>
+ nopeus perus-IDE:hen verrattuna<BR>
+ automaattinen toiminnan optimointi<BR>
+ vakiona ATAPI-, Zip-drive- ja LS-120-tuki<BR>
+ toimii myös ilman ajuria (kuin emolevyn IDE-portti)<BR>
+ liitännät puskuroitu ja terminoitu<BR>
+ poistaa 4 Gt:n ongelman ilman softamuutoksia(!)<BR>
+ yhteensopivuus uusimpienkin IDE-levyjen kanssa<BR>
+ kopiointi levyjen välillä nopeaa samassakin portissa<BR>
+ helppo ohjelmiston asennus
 </P>

 <P>
- tiukka kovopuolen asennus<BR>
- tulee ehkä osittain samalle kohdalle kuin BVision?<BR>
- irrotus ehkä vaikeaa repimättä Gaylea mukana<BR>
- kelloportin käyttö vaatii jatkopalan Flyerin läpi<BR>
- CPU-teho maistuu<BR>
- Chip-muistin hitaus saattaa ehkä rajoittaa nopeutta<BR>
- korkeahko hinta (minkäs teet, erikoistuote...)
 </P>

 <HR>

 <TABLE>
  <TR><TC COLSPAN=2 ALIGN=LEFT>Power Flyer
  <TR><TD>Markkinointi:<TD>Power Computing Ltd, <A HREF="http://www.powerc.com">http://www.powerc.com</A>
  <TR><TD>Myyjä:<TD>Gentle Eye Ky, puh. (03) 363 0048<BR>
          <A HREF="mailto:ge@vip.fi">ge@vip.fi</A>, <A HREF="http://www.ge.vip.fi/">http://www.ge.vip.fi/</A>
  <TR><TD>Hinta:<TD>670 markkaa
  <TR><TD>Nopeus:<TD>16,6 Mt/sek (maksimi)
  <TR><TD>Tukee:<TD>IDE/EIDE (FastATA-2), ATAPI, Zip ja LS-120
  <TR><TD>Siirtomoodit:<TD>PIO0, PIO3 ja PIO4
  <TR><TD>Vaatimukset:<TD>Amiga 1200 ja IDE-kiintolevy
  <TR><TD>Suositus:<TD>tornitettu A1200, 4 Mt Fast, FastATA-2-kiintolevy
  <TR><TD>Testattu:<TD>tornitettu A1200, 32 Mt Fast, Apollo 1260/50 MHz, kaksi FastATA-2-kiintolevyä ja CD-R-asema
 </TABLE>

 <P>
Kirjoittajan tavoittaa sähköpostitse osoitteesta
<A HREF="mailto:jpiippo@ratol.fi">jpiippo@ratol.fi</A> tai Sakunetistä
nimellä Jarmo Piippo.
 </P>

</BODY>
</HTML>
